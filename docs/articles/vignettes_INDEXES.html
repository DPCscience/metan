<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Indexes for simultaneous selection • metan</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Indexes for simultaneous selection">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">metan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vignettes_cross-validation.html">Cross-validation procedure</a>
    </li>
    <li>
      <a href="../articles/vignettes_ammi.html">AMMI</a>
    </li>
    <li>
      <a href="../articles/vignettes_blup.html">BLUP</a>
    </li>
    <li>
      <a href="../articles/vignettes_stability.html">Stability</a>
    </li>
    <li>
      <a href="../articles/vignettes_indexes.html">Multivariate indexes</a>
    </li>
    <li>
      <a href="../articles/vignettes_biometry.html">Biometry</a>
    </li>
    <li>
      <a href="../articles/vignettes_helper.html">Helper</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    More
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../CODE_OF_CONDUCT.html">Code of Conduct</a>
    </li>
    <li>
      <a href="../news/index.html">News</a>
    </li>
    <li>
      <a href="../LICENSE.html">Licence</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://www.researchgate.net/profile/Tiago_Olivoto2">ResearchGate</a>
</li>
<li>
  <a href="https://www.mendeley.com/profiles/tiago-olivoto/">Mendeley</a>
</li>
<li>
  <a href="https://github.com/TiagoOlivoto">Github</a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Indexes for simultaneous selection</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/TiagoOlivoto/metan/blob/master/vignettes/vignettes_indexes.Rmd"><code>vignettes/vignettes_indexes.Rmd</code></a></small>
      <div class="hidden name"><code>vignettes_indexes.Rmd</code></div>

    </div>

    
    
<div id="getting-started" class="section level1">
<h1 class="hasAnchor">
<a href="#getting-started" class="anchor"></a>Getting started</h1>
<p>In this section we will use the data examples <code>data_ge</code> and <code>data_ge2</code> provided in the metan package. For more information, please, see <code><a href="../reference/data_ge.html">?data_ge</a></code> and <code><a href="../reference/data_ge2.html">?data_ge2</a></code>. Other data sets can be used provided that the following columns are in the dataset: environment, genotype, block/replicate and response variable(s).</p>
</div>
<div id="fai-blup-index" class="section level1">
<h1 class="hasAnchor">
<a href="#fai-blup-index" class="anchor"></a>FAI-BLUP index</h1>
<p>The FAI-BLUP is a multi-trait index based on factor analysis and ideotype-design recentely proposed by <span class="citation">Rocha, Machado, and Carneiro (<a href="#ref-Rocha2018">2018</a>)</span>. It is based on factor analysis, when the factorial scores of each ideotype are designed according to the desirable and undesirable factors. Then, a spatial probability is estimated based on genotype-ideotype distance, enabling genotype ranking <span class="citation">(Rocha, Machado, and Carneiro <a href="#ref-Rocha2018">2018</a>)</span>. The BLUPs from genotypes are obtained with the function <code><a href="../reference/WAASB.html">WAASB()</a></code> and then the function <code><a href="../reference/FAI_BLUP.html">FAI_BLUP()</a></code> is used to compute the FAI-BLUP index.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(metan)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(magrittr) <span class="co"># used for the forward-pipe operator %&gt;%</span></a>
<a class="sourceLine" id="cb1-3" title="3"></a>
<a class="sourceLine" id="cb1-4" title="4">FAI =<span class="st"> </span>data_ge2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="st">      </span><span class="kw"><a href="../reference/WAASB.html">WAASB</a></span>(ENV, GEN, REP, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(KW, NKE, PH, EH)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="st">      </span><span class="kw"><a href="../reference/FAI_BLUP.html">FAI_BLUP</a></span>(<span class="dt">DI =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"max"</span>, <span class="st">"max"</span>, <span class="st">"max"</span>, <span class="st">"min"</span>),</a>
<a class="sourceLine" id="cb1-7" title="7">               <span class="dt">UI =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"min"</span>, <span class="st">"min"</span>, <span class="st">"min"</span>, <span class="st">"max"</span>),</a>
<a class="sourceLine" id="cb1-8" title="8">               <span class="dt">SI =</span> <span class="dv">15</span>)</a></code></pre></div>
<pre><code>## Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl =
## control$checkConv, : Model failed to converge with max|grad| = 0.00577455
## (tol = 0.002, component 1)</code></pre>
<pre><code>## Evaluating variable KW 25 % 
## Evaluating variable NKE 50 % 
## Evaluating variable PH 75 % 
## Evaluating variable EH 100 % 
## Done!
## 
## -----------------------------------------------------------------------------------
## Principal Component Analysis
## -----------------------------------------------------------------------------------
##     eigen.values cumulative.var
## PC1   3.14414174       78.60354
## PC2   0.66041176       95.11384
## PC3   0.13857767       98.57828
## PC4   0.05686883      100.00000
## 
## -----------------------------------------------------------------------------------
## Factor Analysis
## -----------------------------------------------------------------------------------
##            FA1 comunalits
## KW  -0.9474560  0.8976729
## NKE -0.7429934  0.5520392
## PH  -0.9429971  0.8892436
## EH  -0.8973216  0.8051861
## 
## -----------------------------------------------------------------------------------
## Comunalit Mean: 0.7860354 
## 
## -----------------------------------------------------------------------------------
## Multitrait stability index
## -----------------------------------------------------------------------------------
##    H13     H6     H2     H5     H1     H4     H3     H8     H9    H10 
## 0.9807 0.8843 0.8413 0.8409 0.8023 0.7972 0.6222 0.2623 0.2354 0.1810 
##     H7    H12    H11 
## 0.1163 0.1014 0.0780 
## 
## -----------------------------------------------------------------------------------
## Selection differential
## -----------------------------------------------------------------------------------
##     Factor Selection differential (%)
## KW       1               1.297090e+00
## NKE      1               5.510697e-08
## PH       1               9.006835e-02
## EH       1               2.407567e-08
## 
## -----------------------------------------------------------------------------------
## Selected genotypes
## H13 H6
## -----------------------------------------------------------------------------------</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(FAI)</a></code></pre></div>
<p><img src="vignettes_indexes_files/figure-html/unnamed-chunk-1-1.png" width="528" style="display: block; margin: auto;"></p>
</div>
<div id="multi-trait-stability-index" class="section level1">
<h1 class="hasAnchor">
<a href="#multi-trait-stability-index" class="anchor"></a>Multi-trait stability index</h1>
<div id="based-on-stability-only" class="section level2">
<h2 class="hasAnchor">
<a href="#based-on-stability-only" class="anchor"></a>Based on stability only</h2>
<p>In the following example, the selection of stable genotypes will consider the</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">MTSI_index =<span class="st"> </span>data_ge2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="st">             </span><span class="kw"><a href="../reference/WAASB.html">WAASB</a></span>(ENV, GEN, REP,</a>
<a class="sourceLine" id="cb5-3" title="3">                   <span class="dt">resp =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(KW, NKE, PH, EH, TKW)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="st">             </span><span class="kw"><a href="../reference/MTSI.html">MTSI</a></span>()</a></code></pre></div>
<pre><code>## Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl =
## control$checkConv, : Model failed to converge with max|grad| = 0.00577455
## (tol = 0.002, component 1)</code></pre>
<pre><code>## Evaluating variable KW 20 %</code></pre>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<pre><code>## Evaluating variable NKE 40 % 
## Evaluating variable PH 60 % 
## Evaluating variable EH 80 % 
## Evaluating variable TKW 100 % 
## Done!
## 
## -------------------------------------------------------------------------------
## Principal Component Analysis
## -------------------------------------------------------------------------------
##     Eigenvalues Variance (%) Cum. variance (%)
## PC1   2.2070167    44.140333          44.14033
## PC2   1.6186853    32.373707          76.51404
## PC3   0.8803207    17.606414          94.12045
## PC4   0.2514611     5.029222          99.14968
## PC5   0.0425162     0.850324         100.00000
## 
## -------------------------------------------------------------------------------
## Factor Analysis - factorial loadings after rotation-
## -------------------------------------------------------------------------------
##            FA1        FA2 Communality Uniquenesses
## KW  -0.1468686  0.9185291   0.8652662   0.13473384
## NKE  0.1741379  0.7365237   0.5727911   0.42720887
## PH  -0.9602598  0.0205209   0.9225199   0.07748007
## EH  -0.9174029 -0.2184732   0.8893586   0.11064136
## TKW -0.6112322  0.4496236   0.5757661   0.42423385
## 
## -------------------------------------------------------------------------------
## Comunalit Mean: 0.7651404 
## 
## -------------------------------------------------------------------------------
## Multitrait stability index
## -------------------------------------------------------------------------------
##    H11     H5     H7    H10     H4    H13    H12     H6     H1     H3 
## 0.9548 1.1634 2.0294 2.1097 2.1989 2.3558 2.7298 2.9740 3.0933 3.2558 
##     H2     H9     H8 
## 3.6918 3.8566 4.0825 
## 
## -------------------------------------------------------------------------------
## Selection differential for WAASB index
## -------------------------------------------------------------------------------
##     Factor        Xo        Xs          SD    SDperc
## PH     FA1 0.2649383 0.1905618 -0.07437652 -28.07315
## EH     FA1 0.2356152 0.1553891 -0.08022607 -34.04962
## TKW    FA1 2.4398931 0.6383057 -1.80158734 -73.83878
## KW     FA2 1.9945663 0.8026270 -1.19193931 -59.75932
## NKE    FA2 2.1329058 1.4627123 -0.67019348 -31.42162
## 
## ------------------------------------------------------------------------------
## Mean of selection differential
## -------------------------------------------------------------------------------
##          Xo          Xs          SD      SDperc 
##   1.4135837   0.6499192  -0.7636645 -45.4284977 
## 
## ------------------------------------------------------------------------------
## Selected genotypes
## H11 H5
## -------------------------------------------------------------------------------</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(MTSI_index)</a></code></pre></div>
<p><img src="vignettes_indexes_files/figure-html/unnamed-chunk-2-1.png" width="528" style="display: block; margin: auto;"></p>
</div>
<div id="based-on-mean-performance-and-stability" class="section level2">
<h2 class="hasAnchor">
<a href="#based-on-mean-performance-and-stability" class="anchor"></a>Based on mean performance and stability</h2>
<p>The following code considers that higher values for KW, NKE, TKW are better, and lower values for PH and EH are better. The simultaneous selection for mean performance and stability will prioritize the mean performance (mean of the variables) rather than their stability across environments.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">MTSI_index2 =<span class="st"> </span>data_ge2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="st">             </span><span class="kw"><a href="../reference/WAASB.html">WAASB</a></span>(ENV, GEN, REP,</a>
<a class="sourceLine" id="cb11-3" title="3">                   <span class="dt">resp =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(KW, NKE, PH, EH, TKW),</a>
<a class="sourceLine" id="cb11-4" title="4">                   <span class="dt">mresp =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">100</span>, <span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">100</span>), <span class="co">#Default</span></a>
<a class="sourceLine" id="cb11-5" title="5">                   <span class="dt">wresp =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">65</span>, <span class="dv">5</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Default is 50</span></a>
<a class="sourceLine" id="cb11-6" title="6"><span class="st">             </span><span class="kw"><a href="../reference/MTSI.html">MTSI</a></span>(<span class="dt">index =</span> <span class="st">"WAASBY"</span>)</a></code></pre></div>
<pre><code>## Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl =
## control$checkConv, : Model failed to converge with max|grad| = 0.00577455
## (tol = 0.002, component 1)</code></pre>
<pre><code>## Evaluating variable KW 20 %</code></pre>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<pre><code>## Evaluating variable NKE 40 % 
## Evaluating variable PH 60 % 
## Evaluating variable EH 80 % 
## Evaluating variable TKW 100 % 
## Done!
## 
## -------------------------------------------------------------------------------
## Principal Component Analysis
## -------------------------------------------------------------------------------
##     Eigenvalues Variance (%) Cum. variance (%)
## PC1  3.38225664   67.6451328          67.64513
## PC2  1.07220072   21.4440144          89.08915
## PC3  0.43819975    8.7639949          97.85314
## PC4  0.07813818    1.5627635          99.41591
## PC5  0.02920472    0.5840943         100.00000
## 
## -------------------------------------------------------------------------------
## Factor Analysis - factorial loadings after rotation-
## -------------------------------------------------------------------------------
##               FA1        FA2 Communality Uniquenesses
## KW  -0.4997542620 -0.8377856   0.9516391   0.04836089
## NKE -0.0006927272 -0.9242319   0.8542052   0.14579484
## PH   0.9402464638  0.1938856   0.9216550   0.07834497
## EH   0.9643408538  0.1629517   0.9565065   0.04349346
## TKW -0.5834916482 -0.6557355   0.7704515   0.22954848
## 
## -------------------------------------------------------------------------------
## Comunalit Mean: 0.8908915 
## 
## -------------------------------------------------------------------------------
## Multitrait stability index
## -------------------------------------------------------------------------------
##     H5    H11     H4    H10    H13     H7     H6     H2    H12     H8 
## 2.4087 3.2668 3.2993 3.5526 3.5550 3.7337 4.2782 4.3503 4.8461 4.8971 
##     H9     H1     H3 
## 5.0170 5.6371 5.9593 
## 
## -------------------------------------------------------------------------------
## Selection differential for WAASBY index
## -------------------------------------------------------------------------------
##     Factor       Xo       Xs       SD   SDperc
## PH     FA1 44.43012 61.06400 16.63388 37.43829
## EH     FA1 49.23772 64.67909 15.44137 31.36085
## KW     FA2 53.25461 72.23216 18.97755 35.63551
## NKE    FA2 44.97683 62.61826 17.64143 39.22337
## TKW    FA2 53.77888 65.08010 11.30122 21.01424
## 
## ------------------------------------------------------------------------------
## Mean of selection differential
## -------------------------------------------------------------------------------
##       Xo       Xs       SD   SDperc 
## 49.13563 65.13472 15.99909 32.93445 
## 
## ------------------------------------------------------------------------------
## Selected genotypes
## H5 H11
## -------------------------------------------------------------------------------</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(MTSI_index2)</a></code></pre></div>
<p><img src="vignettes_indexes_files/figure-html/unnamed-chunk-3-1.png" width="528" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-Rocha2018">
<p>Rocha, João Romero do Amaral Santos de Car, Juarez Campolina Machado, and Pedro Crescêncio Souza Carneiro. 2018. “Multitrait index based on factor analysis and ideotype-design: proposal and application on elephant grass breeding for bioenergy.” <em>GCB Bioenergy</em> 10 (1): 52–60. <a href="https://doi.org/10.1111/gcbb.12443">https://doi.org/10.1111/gcbb.12443</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#getting-started">Getting started</a></li>
      <li><a href="#fai-blup-index">FAI-BLUP index</a></li>
      <li>
<a href="#multi-trait-stability-index">Multi-trait stability index</a><ul class="nav nav-pills nav-stacked">
<li><a href="#based-on-stability-only">Based on stability only</a></li>
      <li><a href="#based-on-mean-performance-and-stability">Based on mean performance and stability</a></li>
      </ul>
</li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://www.researchgate.net/profile/Tiago_Olivoto2">Tiago Olivoto</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
