<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Multi-environment Trial Analysis â€¢ metan</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Multi-environment Trial Analysis">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-140429633-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-140429633-1');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">metan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vignettes_cross-validation.html">Cross-validation procedure</a>
    </li>
    <li>
      <a href="../articles/vignettes_ammi.html">AMMI</a>
    </li>
    <li>
      <a href="../articles/vignettes_blup.html">BLUP</a>
    </li>
    <li>
      <a href="../articles/vignettes_stability.html">Stability</a>
    </li>
    <li>
      <a href="../articles/vignettes_indexes.html">Multivariate indexes</a>
    </li>
    <li>
      <a href="../articles/vignettes_biometry.html">Biometry</a>
    </li>
    <li>
      <a href="../articles/vignettes_helper.html">Helper</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    More
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../CODE_OF_CONDUCT.html">Code of Conduct</a>
    </li>
    <li>
      <a href="../news/index.html">News</a>
    </li>
    <li>
      <a href="../LICENSE.html">Licence</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/TiagoOlivoto">Github</a>
</li>
<li>
  <a href="https://www.researchgate.net/profile/Tiago_Olivoto2">ResearchGate</a>
</li>
<li>
  <a href="https://www.mendeley.com/profiles/tiago-olivoto/">Mendeley</a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><script src="vignettes_metan_files/kePrint-0.0.1/kePrint.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Multi-environment Trial Analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/TiagoOlivoto/metan/blob/master/vignettes/vignettes_metan.Rmd"><code>vignettes/vignettes_metan.Rmd</code></a></small>
      <div class="hidden name"><code>vignettes_metan.Rmd</code></div>

    </div>

    
    
<p>The metan (<strong>m</strong>ulti-<strong>e</strong>nvironment <strong>t</strong>rials <strong>an</strong>alysis) package provides useful functions for analyzing multi-environment trial data using parametric and nonparametric methods, including, but not limited to Additive Main Effects and Multiplicative Interaction (AMMI) and AMMI-based indexes, Best Linear Unbiased Prediction (BLUP), and BLUP-based indexes, Joint-regression analysis, Genotypic confidence index, Superiority index, The main features include, but are not limited to:</p>
<ul>
<li>Within environment analysis of variance</li>
<li>Cross-validation procedures for AMMI-family and BLUP models;</li>
<li>Estimation using AMMI considering different numbers of interation principal component axes;</li>
<li>AMMI-based stability indexes;</li>
<li>Prediction in mixed-effect models;</li>
<li>BLUP-based stability indexes;</li>
<li>Variance components and genetic parameters in mixed-effect models;</li>
<li>Graphics tools for generating biplots.</li>
<li>Parametric and nonparametric stability statistics</li>
</ul>
<div id="extending-the-metan-package" class="section level1">
<h1 class="hasAnchor">
<a href="#extending-the-metan-package" class="anchor"></a>Extending the metan package</h1>
<p>The complete functionality of the metan package, combining theory, programming, and examples with outputs is described at <a href="https://tiagoolivoto.github.io/metan/index.html" class="uri">https://tiagoolivoto.github.io/metan/index.html</a>. Suggestions and criticisms to improve the quality and usability of the package are welcome!</p>
</div>
<div id="brief-examples" class="section level1">
<h1 class="hasAnchor">
<a href="#brief-examples" class="anchor"></a>Brief examples</h1>
<p>The package <a href="https://haozhu233.github.io/kableExtra/"><code>kableExtra</code></a> and <a href="https://github.com/wilkelab/cowplot"><code>cowplot</code></a> were used to generate the tables and arranging the graphics of this vignette. The forward-pipe operators <code>%&gt;%</code> and <code>%&lt;&gt;%</code> may be used in some functions, provided that the package <a href="https://magrittr.tidyverse.org/"><code>magrittr</code></a> is loaded. Brief examples will be run using the dataset <code>data_ge</code> that contains data on two variables assessed in 10 genotypes growing in 11 environments. For more details see <code><a href="../reference/data_ge.html">?data_ge</a></code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(metan)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(cowplot) <span class="co"># used to arrange the graphics</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(kableExtra) <span class="co"># Used to make the tables</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr) <span class="co"># for data manipulation and pipe %&gt;%</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(tibble) <span class="co"># for manipulating rownmanes</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="co"># Function to make HTML tables</span></a>
<a class="sourceLine" id="cb1-7" title="7">print_table =<span class="st"> </span><span class="cf">function</span>(table){</a>
<a class="sourceLine" id="cb1-8" title="8">  <span class="kw">kable</span>(table, <span class="st">"html"</span>, <span class="dt">digits =</span> <span class="dv">3</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="st">    </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span>), <span class="dt">font_size =</span> <span class="dv">12</span>)</a>
<a class="sourceLine" id="cb1-10" title="10">}</a>
<a class="sourceLine" id="cb1-11" title="11"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/str">str</a></span>(data_ge)</a></code></pre></div>
<pre><code>## Classes 'tbl_df', 'tbl' and 'data.frame':    420 obs. of  5 variables:
##  $ ENV: Factor w/ 14 levels "E1","E10","E11",..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ GEN: Factor w/ 10 levels "G1","G10","G2",..: 1 1 1 3 3 3 4 4 4 5 ...
##  $ REP: Factor w/ 3 levels "1","2","3": 1 2 3 1 2 3 1 2 3 1 ...
##  $ GY : num  2.17 2.5 2.43 3.21 2.93 ...
##  $ HM : num  44.9 46.9 47.8 45.2 45.3 ...</code></pre>
</div>
<div id="ammi-model" class="section level1">
<h1 class="hasAnchor">
<a href="#ammi-model" class="anchor"></a>AMMI model</h1>
<div id="cross-validation-procedures" class="section level2">
<h2 class="hasAnchor">
<a href="#cross-validation-procedures" class="anchor"></a>Cross-validation procedures</h2>
<p>The cross-validation procedures implemented in the  are based on the splitting of the original data into a training set and a validation set. The model is fitted using the training set and the predicted value is compared with the validation set. This process is iterated many times, say, 1000 times. The lesser the difference between predicted and validation data, the higher the predictive accuracy of the model. More information may be found <a href="https://tiagoolivoto.github.io/metan/articles/vignettes_CROSS-VALIDATION.html">here.</a></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">CVAL =<span class="st"> </span><span class="kw"><a href="../reference/cv_ammif.html">cv_ammif</a></span>(data_ge,</a>
<a class="sourceLine" id="cb3-2" title="2">                <span class="dt">resp =</span> GY,</a>
<a class="sourceLine" id="cb3-3" title="3">                <span class="dt">gen =</span> GEN,</a>
<a class="sourceLine" id="cb3-4" title="4">                <span class="dt">env =</span> ENV,</a>
<a class="sourceLine" id="cb3-5" title="5">                <span class="dt">rep =</span> REP,</a>
<a class="sourceLine" id="cb3-6" title="6">                <span class="dt">nboot =</span> <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb3-7" title="7">                <span class="dt">nrepval =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb3-8" title="8"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(CVAL)</a></code></pre></div>
<p><img src="vignettes_metan_files/figure-html/unnamed-chunk-2-1.png" width="480"></p>
<div id="fitting-the-model" class="section level3">
<h3 class="hasAnchor">
<a href="#fitting-the-model" class="anchor"></a>Fitting the model</h3>
<p>The AMMI model is fitted with the function <code><a href="../reference/metan-deprecated.html">WAAS.AMMI()</a></code>. Note that a model may be fitted easier and faster using <code>%&gt;%</code> and assigning the arguments in the correct order (environment, genotype, replication and response(s) variable(s). For more details, please see <code><a href="../reference/metan-deprecated.html">?WAAS.AMMI</a></code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">model &lt;-<span class="st"> </span>data_ge <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/waas.html">waas</a></span>(ENV, GEN, REP, GY)</a></code></pre></div>
<pre><code>## Done!</code></pre>
</div>
<div id="biplots" class="section level3">
<h3 class="hasAnchor">
<a href="#biplots" class="anchor"></a>Biplots</h3>
<p>The well-known AMMI2 biplot may be obtained using the function <code><a href="../reference/plot_scores.html">plot_scores()</a></code>. ggplot2-based graphics are obtained. Please, note that since <code><a href="../reference/metan-deprecated.html">WAAS.AMMI()</a></code> and <code>WAASB()</code> functions allow analyzing multiple variables at the same time, e.g., <code>resp = c(v1, v2, ...)</code>, the output <code>model</code> is a list that in this case has one element, GY.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">p1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plot_scores.html">plot_scores</a></span>(model<span class="op">$</span>GY)</a>
<a class="sourceLine" id="cb6-2" title="2">p2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plot_scores.html">plot_scores</a></span>(model<span class="op">$</span>GY,</a>
<a class="sourceLine" id="cb6-3" title="3">                  <span class="dt">type =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb6-4" title="4">                  <span class="dt">polygon =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb6-5" title="5">                  <span class="dt">col.gen =</span> <span class="st">"black"</span>,</a>
<a class="sourceLine" id="cb6-6" title="6">                  <span class="dt">col.env =</span> <span class="st">"gray70"</span>,</a>
<a class="sourceLine" id="cb6-7" title="7">                  <span class="dt">col.segm.env =</span> <span class="st">"gray70"</span>,</a>
<a class="sourceLine" id="cb6-8" title="8">                  <span class="dt">axis.expand =</span> <span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb6-9" title="9"><span class="kw">plot_grid</span>(p1, p2,</a>
<a class="sourceLine" id="cb6-10" title="10">          <span class="dt">align =</span> <span class="st">"v"</span>,</a>
<a class="sourceLine" id="cb6-11" title="11">          <span class="dt">labels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"p1"</span>,<span class="st">"p2"</span>),</a>
<a class="sourceLine" id="cb6-12" title="12">          <span class="dt">ncol =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="vignettes_metan_files/figure-html/unnamed-chunk-4-1.png" width="480"></p>
</div>
<div id="s3-method-predict" class="section level3">
<h3 class="hasAnchor">
<a href="#s3-method-predict" class="anchor"></a>S3 method <code><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict()</a></code>
</h3>
<p>The S3 method <code><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict()</a></code> is implemented for objects of class <code>WAAS.AMMI</code> and may be used to estimate the response of each genotype in each environment considering different number of Interaction Principal Component Axis (IPCA). As a example, we will use four IPCA (number of significant IPCAs) to estimate the GY using the previously fitted <code>model</code> object.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">predicted &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>(model, <span class="dt">naxis =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="kw">print_table</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(predicted<span class="op">$</span>GY))</a></code></pre></div>
<table class="table table table-striped table-hover table-condensed table-responsive">
<thead><tr>
<th style="text-align:left;">
ENV
</th>
<th style="text-align:left;">
GEN
</th>
<th style="text-align:right;">
Y
</th>
<th style="text-align:right;">
resOLS
</th>
<th style="text-align:right;">
Ypred
</th>
<th style="text-align:right;">
ResAMMI
</th>
<th style="text-align:right;">
YpredAMMI
</th>
<th style="text-align:right;">
AMMI0
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G1
</td>
<td style="text-align:right;">
2.366
</td>
<td style="text-align:right;">
-0.084
</td>
<td style="text-align:right;">
2.450
</td>
<td style="text-align:right;">
0.07115484
</td>
<td style="text-align:right;">
2.521273
</td>
<td style="text-align:right;">
2.450
</td>
</tr>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G10
</td>
<td style="text-align:right;">
1.974
</td>
<td style="text-align:right;">
-0.344
</td>
<td style="text-align:right;">
2.318
</td>
<td style="text-align:right;">
-0.35391141
</td>
<td style="text-align:right;">
1.963751
</td>
<td style="text-align:right;">
2.318
</td>
</tr>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G2
</td>
<td style="text-align:right;">
2.902
</td>
<td style="text-align:right;">
0.311
</td>
<td style="text-align:right;">
2.591
</td>
<td style="text-align:right;">
0.29035016
</td>
<td style="text-align:right;">
2.880939
</td>
<td style="text-align:right;">
2.591
</td>
</tr>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G3
</td>
<td style="text-align:right;">
2.889
</td>
<td style="text-align:right;">
0.087
</td>
<td style="text-align:right;">
2.802
</td>
<td style="text-align:right;">
-0.04518795
</td>
<td style="text-align:right;">
2.756598
</td>
<td style="text-align:right;">
2.802
</td>
</tr>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G4
</td>
<td style="text-align:right;">
2.589
</td>
<td style="text-align:right;">
0.100
</td>
<td style="text-align:right;">
2.488
</td>
<td style="text-align:right;">
0.04942370
</td>
<td style="text-align:right;">
2.537781
</td>
<td style="text-align:right;">
2.488
</td>
</tr>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G5
</td>
<td style="text-align:right;">
2.188
</td>
<td style="text-align:right;">
-0.196
</td>
<td style="text-align:right;">
2.384
</td>
<td style="text-align:right;">
-0.07091881
</td>
<td style="text-align:right;">
2.312867
</td>
<td style="text-align:right;">
2.384
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="blup-model" class="section level1">
<h1 class="hasAnchor">
<a href="#blup-model" class="anchor"></a>BLUP model</h1>
<p>The implementation of linear-mixed effect models to predict the response variable in MET is made with <code>WAASB()</code> function. The <em>mixed-effect version</em> of the already fitted AMMI model, where genotype and genotype-vs-environment interaction are assumed to have random effects is then obtained as follows.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">model2 &lt;-<span class="st"> </span>data_ge <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/waasb.html">waasb</a></span>(ENV, GEN, REP, GY)</a></code></pre></div>
<pre><code>## Done!</code></pre>
<p>The mixed-effect model fitted in <code>model2</code> has many outputs. For example, we can easely obtain the Likelihood Ration Test for random effects, the variance components, and the BLUPs for genotypes as follows:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">print_table</span>(model2<span class="op">$</span>GY<span class="op">$</span>LRT)</a></code></pre></div>
<table class="table table table-striped table-hover table-condensed table-responsive">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
npar
</th>
<th style="text-align:right;">
logLik
</th>
<th style="text-align:right;">
AIC
</th>
<th style="text-align:right;">
LRT
</th>
<th style="text-align:right;">
Df
</th>
<th style="text-align:right;">
Pr(&gt;Chisq)
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Complete
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
-214.717
</td>
<td style="text-align:right;">
519.435
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Genotype
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
-224.375
</td>
<td style="text-align:right;">
536.750
</td>
<td style="text-align:right;">
19.315
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Gen vs Env
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
-237.133
</td>
<td style="text-align:right;">
562.266
</td>
<td style="text-align:right;">
44.832
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">print_table</span>(model2<span class="op">$</span>GY<span class="op">$</span>random)</a></code></pre></div>
<table class="table table table-striped table-hover table-condensed table-responsive">
<thead><tr>
<th style="text-align:left;">
Group
</th>
<th style="text-align:right;">
Variance
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
GEN
</td>
<td style="text-align:right;">
0.028
</td>
</tr>
<tr>
<td style="text-align:left;">
GEN:ENV
</td>
<td style="text-align:right;">
0.057
</td>
</tr>
<tr>
<td style="text-align:left;">
Residual
</td>
<td style="text-align:right;">
0.097
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">print_table</span>(model2<span class="op">$</span>GY<span class="op">$</span>ESTIMATES)</a></code></pre></div>
<table class="table table table-striped table-hover table-condensed table-responsive">
<thead><tr>
<th style="text-align:left;">
Parameters
</th>
<th style="text-align:left;">
Values
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
GEI variance
</td>
<td style="text-align:left;">
0.056714 (31.26% of phenotypic variance.)
</td>
</tr>
<tr>
<td style="text-align:left;">
Genotypic variance
</td>
<td style="text-align:left;">
0.028025 (15.45% of phenotypic variance.)
</td>
</tr>
<tr>
<td style="text-align:left;">
Residual variance
</td>
<td style="text-align:left;">
0.096693 (53.29% of phenotypic variance.)
</td>
</tr>
<tr>
<td style="text-align:left;">
Phenotypic variance
</td>
<td style="text-align:left;">
0.181432000765268
</td>
</tr>
<tr>
<td style="text-align:left;">
Heritability
</td>
<td style="text-align:left;">
0.154466820776706
</td>
</tr>
<tr>
<td style="text-align:left;">
GEIr2
</td>
<td style="text-align:left;">
0.31258908175788
</td>
</tr>
<tr>
<td style="text-align:left;">
Heribatility of means
</td>
<td style="text-align:left;">
0.815198214388929
</td>
</tr>
<tr>
<td style="text-align:left;">
Accuracy
</td>
<td style="text-align:left;">
0.902883278385932
</td>
</tr>
<tr>
<td style="text-align:left;">
rge
</td>
<td style="text-align:left;">
0.369694636992275
</td>
</tr>
<tr>
<td style="text-align:left;">
CVg
</td>
<td style="text-align:left;">
6.25999359149609
</td>
</tr>
<tr>
<td style="text-align:left;">
CVr
</td>
<td style="text-align:left;">
11.6277882108427
</td>
</tr>
<tr>
<td style="text-align:left;">
CV ratio
</td>
<td style="text-align:left;">
0.53836494765692
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">print_table</span>(model2<span class="op">$</span>GY<span class="op">$</span>blupGEN)</a></code></pre></div>
<table class="table table table-striped table-hover table-condensed table-responsive">
<thead><tr>
<th style="text-align:right;">
Rank
</th>
<th style="text-align:left;">
GEN
</th>
<th style="text-align:right;">
BLUPg
</th>
<th style="text-align:right;">
Predicted
</th>
<th style="text-align:right;">
LL
</th>
<th style="text-align:right;">
UL
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
G8
</td>
<td style="text-align:right;">
0.269
</td>
<td style="text-align:right;">
2.943
</td>
<td style="text-align:right;">
2.839
</td>
<td style="text-align:right;">
3.046
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
G3
</td>
<td style="text-align:right;">
0.229
</td>
<td style="text-align:right;">
2.903
</td>
<td style="text-align:right;">
2.800
</td>
<td style="text-align:right;">
3.007
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
G2
</td>
<td style="text-align:right;">
0.057
</td>
<td style="text-align:right;">
2.731
</td>
<td style="text-align:right;">
2.628
</td>
<td style="text-align:right;">
2.835
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
G7
</td>
<td style="text-align:right;">
0.054
</td>
<td style="text-align:right;">
2.729
</td>
<td style="text-align:right;">
2.625
</td>
<td style="text-align:right;">
2.832
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
G4
</td>
<td style="text-align:right;">
-0.026
</td>
<td style="text-align:right;">
2.648
</td>
<td style="text-align:right;">
2.544
</td>
<td style="text-align:right;">
2.751
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
G1
</td>
<td style="text-align:right;">
-0.058
</td>
<td style="text-align:right;">
2.617
</td>
<td style="text-align:right;">
2.513
</td>
<td style="text-align:right;">
2.720
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
G5
</td>
<td style="text-align:right;">
-0.112
</td>
<td style="text-align:right;">
2.563
</td>
<td style="text-align:right;">
2.459
</td>
<td style="text-align:right;">
2.666
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
G6
</td>
<td style="text-align:right;">
-0.114
</td>
<td style="text-align:right;">
2.560
</td>
<td style="text-align:right;">
2.456
</td>
<td style="text-align:right;">
2.663
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
G9
</td>
<td style="text-align:right;">
-0.134
</td>
<td style="text-align:right;">
2.541
</td>
<td style="text-align:right;">
2.437
</td>
<td style="text-align:right;">
2.644
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
G10
</td>
<td style="text-align:right;">
-0.166
</td>
<td style="text-align:right;">
2.509
</td>
<td style="text-align:right;">
2.405
</td>
<td style="text-align:right;">
2.612
</td>
</tr>
</tbody>
</table>
<p>An easy way to check the results in the R console is by using the function <code><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary()</a></code></p>
<div id="plotting-the-blups-for-genotypes" class="section level2">
<h2 class="hasAnchor">
<a href="#plotting-the-blups-for-genotypes" class="anchor"></a>Plotting the BLUPs for genotypes</h2>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">p1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plot_blup.html">plot_blup</a></span>(model2<span class="op">$</span>GY)</a>
<a class="sourceLine" id="cb14-2" title="2">p2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plot_blup.html">plot_blup</a></span>(model2<span class="op">$</span>GY,</a>
<a class="sourceLine" id="cb14-3" title="3">                <span class="dt">prob =</span> <span class="fl">0.1</span>,</a>
<a class="sourceLine" id="cb14-4" title="4">                <span class="dt">col.shape  =</span>  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"gray20"</span>, <span class="st">"gray80"</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>()</a>
<a class="sourceLine" id="cb14-5" title="5"><span class="kw">plot_grid</span>(p1, p2,</a>
<a class="sourceLine" id="cb14-6" title="6">          <span class="dt">align =</span> <span class="st">"v"</span>,</a>
<a class="sourceLine" id="cb14-7" title="7">          <span class="dt">labels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"p1"</span>, <span class="st">"p2"</span>),</a>
<a class="sourceLine" id="cb14-8" title="8">          <span class="dt">ncol =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="vignettes_metan_files/figure-html/unnamed-chunk-8-1.png" width="480"></p>
</div>
<div id="blups-for-genotype-vs-environment-interaction" class="section level2">
<h2 class="hasAnchor">
<a href="#blups-for-genotype-vs-environment-interaction" class="anchor"></a>BLUPS for genotype-vs-environment interaction</h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">print_table</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(model2<span class="op">$</span>GY<span class="op">$</span>BLUPgge))</a></code></pre></div>
<table class="table table table-striped table-hover table-condensed table-responsive">
<thead><tr>
<th style="text-align:left;">
ENV
</th>
<th style="text-align:left;">
GEN
</th>
<th style="text-align:right;">
BLUPge
</th>
<th style="text-align:right;">
BLUPg
</th>
<th style="text-align:right;">
BLUPg+ge
</th>
<th style="text-align:right;">
Predicted
</th>
<th style="text-align:right;">
LL
</th>
<th style="text-align:right;">
UL
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G1
</td>
<td style="text-align:right;">
-0.062
</td>
<td style="text-align:right;">
-0.058
</td>
<td style="text-align:right;">
-0.120
</td>
<td style="text-align:right;">
2.401
</td>
<td style="text-align:right;">
2.298
</td>
<td style="text-align:right;">
2.505
</td>
</tr>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G10
</td>
<td style="text-align:right;">
-0.243
</td>
<td style="text-align:right;">
-0.166
</td>
<td style="text-align:right;">
-0.409
</td>
<td style="text-align:right;">
2.112
</td>
<td style="text-align:right;">
2.009
</td>
<td style="text-align:right;">
2.216
</td>
</tr>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G2
</td>
<td style="text-align:right;">
0.207
</td>
<td style="text-align:right;">
0.057
</td>
<td style="text-align:right;">
0.264
</td>
<td style="text-align:right;">
2.784
</td>
<td style="text-align:right;">
2.681
</td>
<td style="text-align:right;">
2.888
</td>
</tr>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G3
</td>
<td style="text-align:right;">
0.088
</td>
<td style="text-align:right;">
0.229
</td>
<td style="text-align:right;">
0.318
</td>
<td style="text-align:right;">
2.838
</td>
<td style="text-align:right;">
2.735
</td>
<td style="text-align:right;">
2.942
</td>
</tr>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G4
</td>
<td style="text-align:right;">
0.060
</td>
<td style="text-align:right;">
-0.026
</td>
<td style="text-align:right;">
0.034
</td>
<td style="text-align:right;">
2.554
</td>
<td style="text-align:right;">
2.451
</td>
<td style="text-align:right;">
2.658
</td>
</tr>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G5
</td>
<td style="text-align:right;">
-0.141
</td>
<td style="text-align:right;">
-0.112
</td>
<td style="text-align:right;">
-0.252
</td>
<td style="text-align:right;">
2.268
</td>
<td style="text-align:right;">
2.165
</td>
<td style="text-align:right;">
2.372
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="parametric-and-non-parametric-statistics" class="section level1">
<h1 class="hasAnchor">
<a href="#parametric-and-non-parametric-statistics" class="anchor"></a>Parametric and non-parametric statistics</h1>
<p>The metan package provides an easy way to compute several world-known stability methods. Up to the version 1.0.3, the following stability methods are implemented:</p>
<ul>
<li>Joint regression analysis, using the function <code><a href="../reference/ge_reg.html">ge_reg()</a></code>
</li>
<li>Genotypic confidence index, using the function <code><a href="../reference/Annicchiarico.html">Annicchiarico()</a></code>
</li>
<li>Nonparametric superiority index, using the function <code><a href="../reference/superiority.html">superiority()</a></code>
</li>
<li>Ecovalence, using the function <code><a href="../reference/ecovalence.html">ecovalence()</a></code>
</li>
<li>Stability analysis and environmental stratification using the function <code><a href="../reference/ge_factanal.html">ge_factanal()</a></code>
</li>
</ul>
<p>The easiest way to compute the above-mentioned stability indexes is by using the function <code><a href="../reference/ge_stats.html">ge_stats()</a></code>. This function basically returns a summary of each method. If you are looking for more details from each method, like plot() and summary(), I suggest computing that methods using their own function.</p>
</div>
<div id="computing-the-indexes" class="section level1">
<h1 class="hasAnchor">
<a href="#computing-the-indexes" class="anchor"></a>Computing the indexes</h1>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">stat_ge &lt;-<span class="st"> </span>data_ge <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/ge_stats.html">ge_stats</a></span>(ENV, GEN, REP, GY)</a>
<a class="sourceLine" id="cb16-2" title="2">dat =<span class="st"> </span>stat_ge<span class="op">$</span>GY</a></code></pre></div>
<p>If you whant to export a summary of results, the simplest way is by using the function summary, as follows:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(stat_ge, <span class="dt">export =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>This comand will create a text file called <em>ge_stats summary.txt</em> in the current working directory.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#extending-the-metan-package">Extending the metan package</a></li>
      <li><a href="#brief-examples">Brief examples</a></li>
      <li>
<a href="#ammi-model">AMMI model</a><ul class="nav nav-pills nav-stacked">
<li><a href="#cross-validation-procedures">Cross-validation procedures</a></li>
      </ul>
</li>
      <li>
<a href="#blup-model">BLUP model</a><ul class="nav nav-pills nav-stacked">
<li><a href="#plotting-the-blups-for-genotypes">Plotting the BLUPs for genotypes</a></li>
      <li><a href="#blups-for-genotype-vs-environment-interaction">BLUPS for genotype-vs-environment interaction</a></li>
      </ul>
</li>
      <li><a href="#parametric-and-non-parametric-statistics">Parametric and non-parametric statistics</a></li>
      <li><a href="#computing-the-indexes">Computing the indexes</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://www.researchgate.net/profile/Tiago_Olivoto2">Tiago Olivoto</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
