<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Multi-environment Trial Analysis • metan</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Multi-environment Trial Analysis">
<meta property="og:description" content="">
<meta property="og:image" content="https://tiagoolivoto.github.io/metan/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-140429633-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-140429633-1');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">metan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vignettes_cross-validation.html">Cross-validation</a>
    </li>
    <li>
      <a href="../articles/vignettes_ammi.html">AMMI</a>
    </li>
    <li>
      <a href="../articles/vignettes_blup.html">BLUP</a>
    </li>
    <li>
      <a href="../articles/vignettes_gge.html">GGE</a>
    </li>
    <li>
      <a href="../articles/vignettes_stability.html">Stability</a>
    </li>
    <li>
      <a href="../articles/vignettes_indexes.html">Multivariate indexes</a>
    </li>
    <li>
      <a href="../articles/vignettes_biometry.html">Biometry</a>
    </li>
    <li>
      <a href="../articles/vignettes_helper.html">Helper</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    More
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../CODE_OF_CONDUCT.html">Code of Conduct</a>
    </li>
    <li>
      <a href="../CONTRIBUTING.html">Contributing</a>
    </li>
    <li>
      <a href="../ISSUE_TEMPLATE.html">Issues</a>
    </li>
    <li>
      <a href="../SUPPORT.html">Support</a>
    </li>
    <li>
      <a href="../LICENSE.html">Licence</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/TiagoOlivoto">Github</a>
</li>
<li>
  <a href="https://www.researchgate.net/profile/Tiago_Olivoto2">ResearchGate</a>
</li>
<li>
  <a href="https://www.mendeley.com/profiles/tiago-olivoto/">Mendeley</a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="vignettes_metan_files/kePrint-0.0.1/kePrint.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Multi-environment Trial Analysis</h1>
                        <h4 class="author">Tiago Olivoto</h4>
            
            <h4 class="date">2019-12-16</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/TiagoOlivoto/metan/blob/master/vignettes/vignettes_metan.Rmd"><code>vignettes/vignettes_metan.Rmd</code></a></small>
      <div class="hidden name"><code>vignettes_metan.Rmd</code></div>

    </div>

    
    
<div id="brief-examples" class="section level1">
<h1 class="hasAnchor">
<a href="#brief-examples" class="anchor"></a>Brief examples</h1>
<p>Brief examples will be shown using the dataset <code>data_ge</code> that contains data on two variables assessed in 10 genotypes growing in 11 environments. For more details see <code><a href="../reference/data_ge.html">?data_ge</a></code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(metan)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(kableExtra) <span class="co"># Used to make the tables</span></a>
<a class="sourceLine" id="cb1-3" title="3"></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="co"># Function to make HTML tables</span></a>
<a class="sourceLine" id="cb1-5" title="5">print_table =<span class="st"> </span><span class="cf">function</span>(table){</a>
<a class="sourceLine" id="cb1-6" title="6">  <span class="kw">kable</span>(table, <span class="st">"html"</span>, <span class="dt">digits =</span> <span class="dv">3</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="st">    </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>,        <span class="st">"responsive"</span>), <span class="dt">font_size =</span> <span class="dv">12</span>)</a>
<a class="sourceLine" id="cb1-8" title="8">}</a>
<a class="sourceLine" id="cb1-9" title="9"><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(data_ge)</a></code></pre></div>
<pre><code>Classes 'tbl_df', 'tbl' and 'data.frame':   420 obs. of  5 variables:
 $ ENV: Factor w/ 14 levels "E1","E10","E11",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ GEN: Factor w/ 10 levels "G1","G10","G2",..: 1 1 1 3 3 3 4 4 4 5 ...
 $ REP: Factor w/ 3 levels "1","2","3": 1 2 3 1 2 3 1 2 3 1 ...
 $ GY : num  2.17 2.5 2.43 3.21 2.93 ...
 $ HM : num  44.9 46.9 47.8 45.2 45.3 ...</code></pre>
</div>
<div id="ammi-model" class="section level1">
<h1 class="hasAnchor">
<a href="#ammi-model" class="anchor"></a>AMMI model</h1>
<div id="fitting-the-model" class="section level3">
<h3 class="hasAnchor">
<a href="#fitting-the-model" class="anchor"></a>Fitting the model</h3>
<p>The AMMI model may be fitted with with both functions <code><a href="../reference/performs_ammi.html">performs_ammi()</a></code> and <code><a href="../reference/waas.html">waas()</a></code>, which is the acronym for the weighted average of absolute scores <span class="citation">(Olivoto, Lúcio, Da silva, Marchioro, et al. <a href="#ref-Olivoto2019" role="doc-biblioref">2019</a>)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">ammi_model &lt;-<span class="st"> </span><span class="kw"><a href="../reference/performs_ammi.html">performs_ammi</a></span>(data_ge, ENV, GEN, REP, <span class="dt">resp =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(GY, HM))</a></code></pre></div>
<pre><code>Evaluating variable GY 0 % 
Evaluating variable HM 100 % 
All variables with significant (p &lt; 0.05) genotype-vs-environment interaction
Done!</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">waas_index &lt;-<span class="st"> </span><span class="kw"><a href="../reference/waas.html">waas</a></span>(data_ge, ENV, GEN, REP, GY, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
</div>
<div id="cross-validation-procedures" class="section level2">
<h2 class="hasAnchor">
<a href="#cross-validation-procedures" class="anchor"></a>Cross-validation procedures</h2>
<p>The cross-validation procedures implemented in the  are based on the splitting of the original data into a training set and a validation set. The model is fitted using the training set and the predicted value is compared with the validation set. This process is iterated many times, say, 1000 times. The lesser the difference between predicted and validation data, the higher the predictive accuracy of the model. More information may be found <a href="https://tiagoolivoto.github.io/metan/articles/vignettes_cross-validation.html">here.</a></p>
<div id="biplots" class="section level3">
<h3 class="hasAnchor">
<a href="#biplots" class="anchor"></a>Biplots</h3>
<p>The well-known AMMI2 biplot may be obtained using the function <code><a href="../reference/plot_scores.html">plot_scores()</a></code>. ggplot2-based graphics are obtained. Please, note that since <code><a href="../reference/performs_ammi.html">performs_ammi()</a></code> and , <code><a href="../reference/waas.html">waas()</a></code> functions allow analyzing multiple variables at the same time, e.g., <code>resp = c(v1, v2, ...)</code>, the output <code>ammi_model</code> is a list that in this case has two elements, (GY and HM).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plot_scores.html">plot_scores</a></span>(ammi_model, <span class="dt">axis.expand =</span> <span class="fl">1.2</span>)</a>
<a class="sourceLine" id="cb6-2" title="2">b &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plot_scores.html">plot_scores</a></span>(ammi_model,</a>
<a class="sourceLine" id="cb6-3" title="3">                 <span class="dt">type =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb6-4" title="4">                 <span class="dt">polygon =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb6-5" title="5">                 <span class="dt">col.gen =</span> <span class="st">"black"</span>,</a>
<a class="sourceLine" id="cb6-6" title="6">                 <span class="dt">col.env =</span> <span class="st">"gray70"</span>,</a>
<a class="sourceLine" id="cb6-7" title="7">                 <span class="dt">col.segm.env =</span> <span class="st">"gray70"</span>,</a>
<a class="sourceLine" id="cb6-8" title="8">                 <span class="dt">axis.expand =</span> <span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb6-9" title="9"><span class="kw"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span>(a, b, <span class="dt">labels =</span> letters[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dt">ncol =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="vignettes_metan_files/figure-html/unnamed-chunk-3-1.png" width="480"></p>
</div>
<div id="s3-method-predict" class="section level3">
<h3 class="hasAnchor">
<a href="#s3-method-predict" class="anchor"></a>S3 method predict()</h3>
<p>The S3 method <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code> is implemented for objects of class <code>performs_ammi</code> and may be used to estimate the response of each genotype in each environment considering different number of Interaction Principal Component Axis (IPCA). As a example, to predict the variables GY and HM we will use four and six IPCA (number of significant IPCAs, respectively).</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">predicted &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(ammi_model, <span class="dt">naxis =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">4</span>, <span class="dv">6</span>))</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="kw">print_table</span>(<span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(predicted<span class="op">$</span>GY))</a></code></pre></div>
<table class="table table table-striped table-hover table-condensed table-responsive">
<thead><tr>
<th style="text-align:left;">
ENV
</th>
<th style="text-align:left;">
GEN
</th>
<th style="text-align:right;">
Y
</th>
<th style="text-align:right;">
resOLS
</th>
<th style="text-align:right;">
Ypred
</th>
<th style="text-align:right;">
ResAMMI
</th>
<th style="text-align:right;">
YpredAMMI
</th>
<th style="text-align:right;">
AMMI0
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G1
</td>
<td style="text-align:right;">
2.366
</td>
<td style="text-align:right;">
-0.084
</td>
<td style="text-align:right;">
2.450
</td>
<td style="text-align:right;">
0.07115484
</td>
<td style="text-align:right;">
2.521273
</td>
<td style="text-align:right;">
2.450
</td>
</tr>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G10
</td>
<td style="text-align:right;">
1.974
</td>
<td style="text-align:right;">
-0.344
</td>
<td style="text-align:right;">
2.318
</td>
<td style="text-align:right;">
-0.35391141
</td>
<td style="text-align:right;">
1.963751
</td>
<td style="text-align:right;">
2.318
</td>
</tr>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G2
</td>
<td style="text-align:right;">
2.902
</td>
<td style="text-align:right;">
0.311
</td>
<td style="text-align:right;">
2.591
</td>
<td style="text-align:right;">
0.29035016
</td>
<td style="text-align:right;">
2.880939
</td>
<td style="text-align:right;">
2.591
</td>
</tr>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G3
</td>
<td style="text-align:right;">
2.889
</td>
<td style="text-align:right;">
0.087
</td>
<td style="text-align:right;">
2.802
</td>
<td style="text-align:right;">
-0.04518795
</td>
<td style="text-align:right;">
2.756598
</td>
<td style="text-align:right;">
2.802
</td>
</tr>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G4
</td>
<td style="text-align:right;">
2.589
</td>
<td style="text-align:right;">
0.100
</td>
<td style="text-align:right;">
2.488
</td>
<td style="text-align:right;">
0.04942370
</td>
<td style="text-align:right;">
2.537781
</td>
<td style="text-align:right;">
2.488
</td>
</tr>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G5
</td>
<td style="text-align:right;">
2.188
</td>
<td style="text-align:right;">
-0.196
</td>
<td style="text-align:right;">
2.384
</td>
<td style="text-align:right;">
-0.07091881
</td>
<td style="text-align:right;">
2.312867
</td>
<td style="text-align:right;">
2.384
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="blup-model" class="section level1">
<h1 class="hasAnchor">
<a href="#blup-model" class="anchor"></a>BLUP model</h1>
<p>The implementation of linear-mixed effect models to predict the response variable in MET is made with <code><a href="../reference/waasb.html">waasb()</a></code> function. The <em>mixed-effect version</em> of the already fitted AMMI model, where genotype and genotype-vs-environment interaction are assumed to have random effects is then obtained as follows.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">model2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/waasb.html">waasb</a></span>(data_ge, ENV, GEN, REP, GY)</a></code></pre></div>
<pre><code>All variables with significant (p &lt; 0.05) genotype-vs-environment interaction
Done!</code></pre>
<p>The mixed-effect model fitted in <code>model2</code> has many outputs. For example, we can easily obtain the Likelihood Ration Test for random effects, the variance components, and the BLUPs for genotypes as follows:</p>
<div id="residual-plots" class="section level2">
<h2 class="hasAnchor">
<a href="#residual-plots" class="anchor"></a>Residual plots</h2>
<p>Several residual plots may be obtained applying the S3 generic function <code><a href="https://rdrr.io/r/graphics/plot.html">plot()</a></code> to an object of class <code>waasb</code> (or <code>waas</code>).</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(model2, <span class="dt">which =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">7</span>), <span class="dt">ncol =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="vignettes_metan_files/figure-html/unnamed-chunk-6-1.png" width="384"></p>
</div>
<div id="distribution-of-random-effects" class="section level2">
<h2 class="hasAnchor">
<a href="#distribution-of-random-effects" class="anchor"></a>Distribution of random effects</h2>
<p>The distribution of the random effects may be obtained using the argument <code>type = "re"</code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(model2, <span class="dt">type =</span> <span class="st">"re"</span>, <span class="dt">which =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">ncol =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="vignettes_metan_files/figure-html/unnamed-chunk-7-1.png" width="384"></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">print_table</span>(model2<span class="op">$</span>GY<span class="op">$</span>LRT)</a></code></pre></div>
<table class="table table table-striped table-hover table-condensed table-responsive">
<thead><tr>
<th style="text-align:left;">
model
</th>
<th style="text-align:right;">
npar
</th>
<th style="text-align:right;">
logLik
</th>
<th style="text-align:right;">
AIC
</th>
<th style="text-align:right;">
LRT
</th>
<th style="text-align:right;">
Df
</th>
<th style="text-align:right;">
Pr(&gt;Chisq)
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Complete
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
-214.717
</td>
<td style="text-align:right;">
519.435
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Genotype
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
-224.375
</td>
<td style="text-align:right;">
536.750
</td>
<td style="text-align:right;">
19.315
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Gen:Env
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
-237.133
</td>
<td style="text-align:right;">
562.266
</td>
<td style="text-align:right;">
44.832
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">print_table</span>(model2<span class="op">$</span>GY<span class="op">$</span>random)</a></code></pre></div>
<table class="table table table-striped table-hover table-condensed table-responsive">
<thead><tr>
<th style="text-align:left;">
Group
</th>
<th style="text-align:right;">
Variance
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
GEN
</td>
<td style="text-align:right;">
0.028
</td>
</tr>
<tr>
<td style="text-align:left;">
GEN:ENV
</td>
<td style="text-align:right;">
0.057
</td>
</tr>
<tr>
<td style="text-align:left;">
Residual
</td>
<td style="text-align:right;">
0.097
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">print_table</span>(model2<span class="op">$</span>GY<span class="op">$</span>ESTIMATES)</a></code></pre></div>
<table class="table table table-striped table-hover table-condensed table-responsive">
<thead><tr>
<th style="text-align:left;">
Parameters
</th>
<th style="text-align:right;">
Values
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
GEI variance
</td>
<td style="text-align:right;">
0.057
</td>
</tr>
<tr>
<td style="text-align:left;">
GEI (%)
</td>
<td style="text-align:right;">
31.259
</td>
</tr>
<tr>
<td style="text-align:left;">
Genotypic variance
</td>
<td style="text-align:right;">
0.028
</td>
</tr>
<tr>
<td style="text-align:left;">
Gen (%)
</td>
<td style="text-align:right;">
15.447
</td>
</tr>
<tr>
<td style="text-align:left;">
Residual variance
</td>
<td style="text-align:right;">
0.097
</td>
</tr>
<tr>
<td style="text-align:left;">
Res (%)
</td>
<td style="text-align:right;">
53.294
</td>
</tr>
<tr>
<td style="text-align:left;">
Phenotypic variance
</td>
<td style="text-align:right;">
0.181
</td>
</tr>
<tr>
<td style="text-align:left;">
Heritability
</td>
<td style="text-align:right;">
0.154
</td>
</tr>
<tr>
<td style="text-align:left;">
GEIr2
</td>
<td style="text-align:right;">
0.313
</td>
</tr>
<tr>
<td style="text-align:left;">
Heribatility of means
</td>
<td style="text-align:right;">
0.815
</td>
</tr>
<tr>
<td style="text-align:left;">
Accuracy
</td>
<td style="text-align:right;">
0.903
</td>
</tr>
<tr>
<td style="text-align:left;">
rge
</td>
<td style="text-align:right;">
0.370
</td>
</tr>
<tr>
<td style="text-align:left;">
CVg
</td>
<td style="text-align:right;">
6.260
</td>
</tr>
<tr>
<td style="text-align:left;">
CVr
</td>
<td style="text-align:right;">
11.628
</td>
</tr>
<tr>
<td style="text-align:left;">
CV ratio
</td>
<td style="text-align:right;">
0.538
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">print_table</span>(model2<span class="op">$</span>GY<span class="op">$</span>blupGEN)</a></code></pre></div>
<table class="table table table-striped table-hover table-condensed table-responsive">
<thead><tr>
<th style="text-align:right;">
Rank
</th>
<th style="text-align:left;">
GEN
</th>
<th style="text-align:right;">
BLUPg
</th>
<th style="text-align:right;">
Predicted
</th>
<th style="text-align:right;">
LL
</th>
<th style="text-align:right;">
UL
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
G8
</td>
<td style="text-align:right;">
0.269
</td>
<td style="text-align:right;">
2.943
</td>
<td style="text-align:right;">
2.839
</td>
<td style="text-align:right;">
3.046
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
G3
</td>
<td style="text-align:right;">
0.229
</td>
<td style="text-align:right;">
2.903
</td>
<td style="text-align:right;">
2.800
</td>
<td style="text-align:right;">
3.007
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
G2
</td>
<td style="text-align:right;">
0.057
</td>
<td style="text-align:right;">
2.731
</td>
<td style="text-align:right;">
2.628
</td>
<td style="text-align:right;">
2.835
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
G7
</td>
<td style="text-align:right;">
0.054
</td>
<td style="text-align:right;">
2.729
</td>
<td style="text-align:right;">
2.625
</td>
<td style="text-align:right;">
2.832
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
G4
</td>
<td style="text-align:right;">
-0.026
</td>
<td style="text-align:right;">
2.648
</td>
<td style="text-align:right;">
2.544
</td>
<td style="text-align:right;">
2.751
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
G1
</td>
<td style="text-align:right;">
-0.058
</td>
<td style="text-align:right;">
2.617
</td>
<td style="text-align:right;">
2.513
</td>
<td style="text-align:right;">
2.720
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
G5
</td>
<td style="text-align:right;">
-0.112
</td>
<td style="text-align:right;">
2.563
</td>
<td style="text-align:right;">
2.459
</td>
<td style="text-align:right;">
2.666
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
G6
</td>
<td style="text-align:right;">
-0.114
</td>
<td style="text-align:right;">
2.560
</td>
<td style="text-align:right;">
2.456
</td>
<td style="text-align:right;">
2.663
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
G9
</td>
<td style="text-align:right;">
-0.134
</td>
<td style="text-align:right;">
2.541
</td>
<td style="text-align:right;">
2.437
</td>
<td style="text-align:right;">
2.644
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
G10
</td>
<td style="text-align:right;">
-0.166
</td>
<td style="text-align:right;">
2.509
</td>
<td style="text-align:right;">
2.405
</td>
<td style="text-align:right;">
2.612
</td>
</tr>
</tbody>
</table>
<p>An easy way to check the results in the R console is by using the function <code><a href="https://rdrr.io/r/base/print.html">print()</a></code></p>
</div>
<div id="plotting-the-blups-for-genotypes" class="section level2">
<h2 class="hasAnchor">
<a href="#plotting-the-blups-for-genotypes" class="anchor"></a>Plotting the BLUPs for genotypes</h2>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb16-2" title="2">c &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plot_blup.html">plot_blup</a></span>(model2)</a>
<a class="sourceLine" id="cb16-3" title="3">d &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plot_blup.html">plot_blup</a></span>(model2,</a>
<a class="sourceLine" id="cb16-4" title="4">               <span class="dt">prob =</span> <span class="fl">0.1</span>,</a>
<a class="sourceLine" id="cb16-5" title="5">               <span class="dt">col.shape  =</span>  <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"gray20"</span>, <span class="st">"gray80"</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-6" title="6"><span class="st">      </span><span class="kw">coord_flip</span>()</a>
<a class="sourceLine" id="cb16-7" title="7"><span class="kw"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span>(c, d,<span class="dt">labels =</span> letters[<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">ncol =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="vignettes_metan_files/figure-html/unnamed-chunk-9-1.png" width="384"></p>
</div>
<div id="blups-for-genotype-vs-environment-interaction" class="section level2">
<h2 class="hasAnchor">
<a href="#blups-for-genotype-vs-environment-interaction" class="anchor"></a>BLUPS for genotype-vs-environment interaction</h2>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw">print_table</span>(<span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(model2<span class="op">$</span>GY<span class="op">$</span>BLUPgge))</a></code></pre></div>
<table class="table table table-striped table-hover table-condensed table-responsive">
<thead><tr>
<th style="text-align:left;">
ENV
</th>
<th style="text-align:left;">
GEN
</th>
<th style="text-align:right;">
BLUPge
</th>
<th style="text-align:right;">
BLUPg
</th>
<th style="text-align:right;">
BLUPg+ge
</th>
<th style="text-align:right;">
Predicted
</th>
<th style="text-align:right;">
LL
</th>
<th style="text-align:right;">
UL
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G1
</td>
<td style="text-align:right;">
-0.062
</td>
<td style="text-align:right;">
-0.058
</td>
<td style="text-align:right;">
-0.120
</td>
<td style="text-align:right;">
2.401
</td>
<td style="text-align:right;">
2.298
</td>
<td style="text-align:right;">
2.505
</td>
</tr>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G10
</td>
<td style="text-align:right;">
-0.243
</td>
<td style="text-align:right;">
-0.166
</td>
<td style="text-align:right;">
-0.409
</td>
<td style="text-align:right;">
2.112
</td>
<td style="text-align:right;">
2.009
</td>
<td style="text-align:right;">
2.216
</td>
</tr>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G2
</td>
<td style="text-align:right;">
0.207
</td>
<td style="text-align:right;">
0.057
</td>
<td style="text-align:right;">
0.264
</td>
<td style="text-align:right;">
2.784
</td>
<td style="text-align:right;">
2.681
</td>
<td style="text-align:right;">
2.888
</td>
</tr>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G3
</td>
<td style="text-align:right;">
0.088
</td>
<td style="text-align:right;">
0.229
</td>
<td style="text-align:right;">
0.318
</td>
<td style="text-align:right;">
2.838
</td>
<td style="text-align:right;">
2.735
</td>
<td style="text-align:right;">
2.942
</td>
</tr>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G4
</td>
<td style="text-align:right;">
0.060
</td>
<td style="text-align:right;">
-0.026
</td>
<td style="text-align:right;">
0.034
</td>
<td style="text-align:right;">
2.554
</td>
<td style="text-align:right;">
2.451
</td>
<td style="text-align:right;">
2.658
</td>
</tr>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G5
</td>
<td style="text-align:right;">
-0.141
</td>
<td style="text-align:right;">
-0.112
</td>
<td style="text-align:right;">
-0.252
</td>
<td style="text-align:right;">
2.268
</td>
<td style="text-align:right;">
2.165
</td>
<td style="text-align:right;">
2.372
</td>
</tr>
</tbody>
</table>
</div>
<div id="blup-based-stability-index" class="section level2">
<h2 class="hasAnchor">
<a href="#blup-based-stability-index" class="anchor"></a>BLUP-based stability index</h2>
<p>The WAASB index <span class="citation">(Olivoto, Lúcio, Da silva, Marchioro, et al. <a href="#ref-Olivoto2019" role="doc-biblioref">2019</a>)</span> is a quantitative stability measure based on the weighted average of the absolute scores from the singular value decomposition of the BLUPs for genotype-vs-interaction effects and was already computed when we fitted the model with <code><a href="../reference/waas.html">waas()</a></code>. This statistic may be shown with <code><a href="../reference/get_model_data.html">get_model_data()</a></code>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="kw"><a href="../reference/get_model_data.html">get_model_data</a></span>(model2, <span class="dt">what =</span> <span class="st">"WAASB"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-2" title="2"><span class="st">  </span><span class="kw">print_table</span>()</a></code></pre></div>
<table class="table table table-striped table-hover table-condensed table-responsive">
<thead><tr>
<th style="text-align:left;">
gen
</th>
<th style="text-align:right;">
GY
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
G1
</td>
<td style="text-align:right;">
0.134
</td>
</tr>
<tr>
<td style="text-align:left;">
G10
</td>
<td style="text-align:right;">
0.465
</td>
</tr>
<tr>
<td style="text-align:left;">
G2
</td>
<td style="text-align:right;">
0.214
</td>
</tr>
<tr>
<td style="text-align:left;">
G3
</td>
<td style="text-align:right;">
0.099
</td>
</tr>
<tr>
<td style="text-align:left;">
G4
</td>
<td style="text-align:right;">
0.248
</td>
</tr>
<tr>
<td style="text-align:left;">
G5
</td>
<td style="text-align:right;">
0.218
</td>
</tr>
<tr>
<td style="text-align:left;">
G6
</td>
<td style="text-align:right;">
0.172
</td>
</tr>
<tr>
<td style="text-align:left;">
G7
</td>
<td style="text-align:right;">
0.319
</td>
</tr>
<tr>
<td style="text-align:left;">
G8
</td>
<td style="text-align:right;">
0.265
</td>
</tr>
<tr>
<td style="text-align:left;">
G9
</td>
<td style="text-align:right;">
0.372
</td>
</tr>
</tbody>
</table>
<p>The function <code><a href="../reference/Resende_indexes.html">Resende_indexes()</a></code> may be used to compute the harmonic mean of genotypic values (HMGV), the relative performance of the genotypic values (RPGV) and the harmonic mean of the relative performance of genotypic values (HMRPGV). See <span class="citation">Alves et al. (<a href="#ref-Alves2018" role="doc-biblioref">2018</a>)</span> for more details.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">index &lt;-<span class="st"> </span>model2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-2" title="2"><span class="st">  </span><span class="kw"><a href="../reference/Resende_indexes.html">Resende_indexes</a></span>()</a>
<a class="sourceLine" id="cb19-3" title="3">  <span class="kw">print_table</span>(index<span class="op">$</span>GY)</a></code></pre></div>
<table class="table table table-striped table-hover table-condensed table-responsive">
<thead><tr>
<th style="text-align:left;">
GEN
</th>
<th style="text-align:right;">
Y
</th>
<th style="text-align:right;">
HMGV
</th>
<th style="text-align:right;">
HMGV_R
</th>
<th style="text-align:right;">
RPGV
</th>
<th style="text-align:right;">
RPGV_Y
</th>
<th style="text-align:right;">
RPGV_R
</th>
<th style="text-align:right;">
HMRPGV
</th>
<th style="text-align:right;">
HMRPGV_Y
</th>
<th style="text-align:right;">
HMRPGV_R
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
G1
</td>
<td style="text-align:right;">
2.604
</td>
<td style="text-align:right;">
2.316
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0.969
</td>
<td style="text-align:right;">
2.591
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0.967
</td>
<td style="text-align:right;">
2.585
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:left;">
G10
</td>
<td style="text-align:right;">
2.471
</td>
<td style="text-align:right;">
2.112
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0.913
</td>
<td style="text-align:right;">
2.442
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0.896
</td>
<td style="text-align:right;">
2.397
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
G2
</td>
<td style="text-align:right;">
2.744
</td>
<td style="text-align:right;">
2.466
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1.025
</td>
<td style="text-align:right;">
2.742
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1.020
</td>
<td style="text-align:right;">
2.727
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
G3
</td>
<td style="text-align:right;">
2.955
</td>
<td style="text-align:right;">
2.681
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1.105
</td>
<td style="text-align:right;">
2.955
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1.104
</td>
<td style="text-align:right;">
2.952
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
G4
</td>
<td style="text-align:right;">
2.642
</td>
<td style="text-align:right;">
2.388
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.990
</td>
<td style="text-align:right;">
2.649
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.988
</td>
<td style="text-align:right;">
2.643
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
G5
</td>
<td style="text-align:right;">
2.537
</td>
<td style="text-align:right;">
2.302
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0.954
</td>
<td style="text-align:right;">
2.552
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0.952
</td>
<td style="text-align:right;">
2.546
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:left;">
G6
</td>
<td style="text-align:right;">
2.534
</td>
<td style="text-align:right;">
2.304
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0.954
</td>
<td style="text-align:right;">
2.552
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0.952
</td>
<td style="text-align:right;">
2.546
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:left;">
G7
</td>
<td style="text-align:right;">
2.741
</td>
<td style="text-align:right;">
2.520
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1.037
</td>
<td style="text-align:right;">
2.773
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1.031
</td>
<td style="text-align:right;">
2.757
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
G8
</td>
<td style="text-align:right;">
3.004
</td>
<td style="text-align:right;">
2.740
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.126
</td>
<td style="text-align:right;">
3.011
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.122
</td>
<td style="text-align:right;">
3.001
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
G9
</td>
<td style="text-align:right;">
2.510
</td>
<td style="text-align:right;">
2.177
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
0.926
</td>
<td style="text-align:right;">
2.477
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
0.917
</td>
<td style="text-align:right;">
2.453
</td>
<td style="text-align:right;">
9
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="gge-model" class="section level1">
<h1 class="hasAnchor">
<a href="#gge-model" class="anchor"></a>GGE model</h1>
<div id="fitting-the-model-1" class="section level2">
<h2 class="hasAnchor">
<a href="#fitting-the-model-1" class="anchor"></a>Fitting the model</h2>
<p>The GGE model is fitted with the function <code><a href="../reference/gge.html">gge()</a></code>. This function produces a GGE model based on both a two-way table (in our case the object <code>table</code>) with genotypes in the rows and environments in columns, or a data.frame containing at least the columns for genotypes, environments and the response variable(s).</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="co"># Using a data.frame</span></a>
<a class="sourceLine" id="cb20-2" title="2">gge_model &lt;-<span class="st"> </span><span class="kw"><a href="../reference/gge.html">gge</a></span>(data_ge, ENV, GEN, GY)</a>
<a class="sourceLine" id="cb20-3" title="3"></a>
<a class="sourceLine" id="cb20-4" title="4"><span class="co"># Using a two-way table</span></a>
<a class="sourceLine" id="cb20-5" title="5">ge_table &lt;-<span class="st"> </span><span class="kw"><a href="../reference/make_mat.html">make_mat</a></span>(data_ge, GEN, ENV, GY)</a>
<a class="sourceLine" id="cb20-6" title="6">gge_model &lt;-<span class="st"> </span><span class="kw"><a href="../reference/gge.html">gge</a></span>(ge_table, <span class="dt">table =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
</div>
<div id="visualizing-the-biplot" class="section level2">
<h2 class="hasAnchor">
<a href="#visualizing-the-biplot" class="anchor"></a>Visualizing the Biplot</h2>
<p>The generic function <code><a href="https://rdrr.io/r/graphics/plot.html">plot()</a></code> is used to generate a biplot using as input a fitted model of class <code>gge</code>. The type of biplot is chosen by the argument <code>type</code> in the function. Ten biplots type are available according to {<span class="citation">Yan and Kang (<a href="#ref-Yan2003" role="doc-biblioref">2003</a>)</span>}.</p>
<ul>
<li>
<code>type = 1</code> A basic biplot.</li>
<li>
<code>type =  2</code> Mean performance vs. stability.</li>
<li>
<code>type =  3</code> Which-won-where.</li>
<li>
<code>type =  4</code> Discriminativeness vs. representativeness.</li>
<li>
<code>type =  5</code> Examine an environment.</li>
<li>
<code>type =  6</code> Ranking environments.</li>
<li>
<code>type =  7</code> Examine a genotype.</li>
<li>
<code>type =  8</code> Ranking gentoypes.</li>
<li>
<code>type =  9</code> Compare two genotypes.</li>
<li>
<code>type =  10</code> Relationship among environments.</li>
</ul>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">e &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(gge_model)</a>
<a class="sourceLine" id="cb21-2" title="2">f &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(gge_model, <span class="dt">type =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb21-3" title="3"><span class="kw"><a href="../reference/arrange_ggplot.html">arrange_ggplot</a></span>(e, f, <span class="dt">labels =</span> letters[<span class="dv">5</span><span class="op">:</span><span class="dv">6</span>], <span class="dt">ncol =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="vignettes_metan_files/figure-html/unnamed-chunk-14-1.png" width="384"></p>
</div>
</div>
<div id="parametric-and-non-parametric-statistics" class="section level1">
<h1 class="hasAnchor">
<a href="#parametric-and-non-parametric-statistics" class="anchor"></a>Parametric and non-parametric statistics</h1>
<p>The metan package provides an easy way to compute several world-known stability methods. Up to the version 0.2.0, the following stability methods are implemented:</p>
<ul>
<li>Joint regression analysis <span class="citation">(Eberhart and Russell <a href="#ref-Eberhart1966" role="doc-biblioref">1966</a>)</span>, using the function <code><a href="../reference/ge_reg.html">ge_reg()</a></code>
</li>
<li>Genotypic confidence index <span class="citation">(Annicchiarico <a href="#ref-Annicchiarico1992" role="doc-biblioref">1992</a>)</span>, using the function <code><a href="../reference/Annicchiarico.html">Annicchiarico()</a></code>
</li>
<li>Nonparametric superiority index <span class="citation">(Lin and Binns <a href="#ref-Lin1988" role="doc-biblioref">1988</a>)</span>, using the function <code><a href="../reference/superiority.html">superiority()</a></code>
</li>
<li>Ecovalence <span class="citation">(Wricke <a href="#ref-Wricke1965" role="doc-biblioref">1965</a>)</span>, using the function <code><a href="../reference/ecovalence.html">ecovalence()</a></code>
</li>
<li>Stability analysis and environmental stratification <span class="citation">(Murakami and Cruz <a href="#ref-murakami2004" role="doc-biblioref">2004</a>)</span>, using the function <code><a href="../reference/ge_factanal.html">ge_factanal()</a></code>
</li>
</ul>
<p>The easiest way to compute the above-mentioned stability indexes is by using the function <code><a href="../reference/ge_stats.html">ge_stats()</a></code>. This function basically returns a summary of each method. If you are looking for more details from each method like <code><a href="https://rdrr.io/r/graphics/plot.html">plot()</a></code> and <code><a href="https://rdrr.io/r/base/print.html">print()</a></code>, I suggest computing that methods using their own function.</p>
</div>
<div id="computing-the-indexes" class="section level1">
<h1 class="hasAnchor">
<a href="#computing-the-indexes" class="anchor"></a>Computing the indexes</h1>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">stat_ge &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ge_stats.html">ge_stats</a></span>(data_ge, ENV, GEN, REP, GY)</a></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw"><a href="../reference/get_model_data.html">get_model_data</a></span>(stat_ge, <span class="st">"stats"</span>)</a></code></pre></div>
<pre><code># A tibble: 10 x 32
   var   gen       Y   Var Shukla  Wi_g  Wi_f  Wi_u Ecoval   bij      Sij    R2
   &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;
 1 GY    G1     2.60 10.9  0.0280  84.4  89.2  81.1  1.22  1.06  -0.00142 0.966
 2 GY    G10    2.47 14.2  0.244   59.2  64.6  54.4  7.96  1.12   0.177   0.823
 3 GY    G2     2.74 11.3  0.0861  82.8  95.3  75.6  3.03  1.05   0.0497  0.913
 4 GY    G3     2.96 10.1  0.0121 104.   99.7 107.   0.725 1.03  -0.0128  0.977
 5 GY    G4     2.64  8.93 0.0640  85.9  79.5  91.9  2.34  0.937  0.0298  0.917
 6 GY    G5     2.54  7.82 0.0480  82.7  82.2  82.4  1.84  0.887  0.00902 0.937
 7 GY    G6     2.53  7.34 0.0468  83.0  83.7  81.8  1.81  0.861  0.00304 0.942
 8 GY    G7     2.74  7.33 0.122   83.9  77.6  93.4  4.16  0.819  0.0579  0.852
 9 GY    G8     3.00 10.8  0.0712  98.8  90.5 107.   2.57  1.03   0.0382  0.922
10 GY    G9     2.51 14.7  0.167   68.8  68.9  70.3  5.56  1.19   0.0938  0.897
# ... with 20 more variables: ASV &lt;dbl&gt;, SIPC &lt;dbl&gt;, EV &lt;dbl&gt;, ZA &lt;dbl&gt;,
#   WAAS &lt;dbl&gt;, HMGV &lt;dbl&gt;, RPGV &lt;dbl&gt;, HMRPGV &lt;dbl&gt;, Pi_a &lt;dbl&gt;, Pi_f &lt;dbl&gt;,
#   Pi_u &lt;dbl&gt;, Gai &lt;dbl&gt;, S1 &lt;dbl&gt;, S2 &lt;dbl&gt;, S3 &lt;dbl&gt;, S6 &lt;dbl&gt;, N1 &lt;dbl&gt;,
#   N2 &lt;dbl&gt;, N3 &lt;dbl&gt;, N4 &lt;dbl&gt;</code></pre>
</div>
<div id="selection-based-on-multiple-traits" class="section level1">
<h1 class="hasAnchor">
<a href="#selection-based-on-multiple-traits" class="anchor"></a>Selection based on multiple traits</h1>
<p>The multi-trait stability index (MTSI) was proposed by <span class="citation">Olivoto, Lúcio, Da silva, Sari, et al. (<a href="#ref-Olivoto2019a" role="doc-biblioref">2019</a>)</span> and is used for simultaneous selection considering mean performance and stability (of several traits) in the analysis of METs using both fixed and mixed-effect models. Note that a model may be fitted easier and faster using the forward-pipe <code><a href="../reference/pipe.html">%&gt;%</a></code> and assigning the arguments in the correct order (environment, genotype, replication and response(s) variable(s). Using <code><a href="../reference/pipe.html">%&gt;%</a></code> make it the coding logical and clean especially when the output of a function is used as input in a second function.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1">data_ge2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-2" title="2"><span class="st">  </span><span class="kw"><a href="../reference/waasb.html">waasb</a></span>(ENV, GEN, REP,</a>
<a class="sourceLine" id="cb25-3" title="3">        <span class="dt">resp =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(KW, NKE, PH, EH, TKW),</a>
<a class="sourceLine" id="cb25-4" title="4">        <span class="dt">verbose =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-5" title="5"><span class="st">  </span><span class="kw"><a href="../reference/mtsi.html">mtsi</a></span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-6" title="6"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>()</a></code></pre></div>
</div>
<div id="getting-help" class="section level1">
<h1 class="hasAnchor">
<a href="#getting-help" class="anchor"></a>Getting help</h1>
<ul>
<li><p>The complete functionality of the metan package, combining theory, programming, and examples with outputs is described <a href="https://tiagoolivoto.github.io/metan/index.html">here</a>.</p></li>
<li><p>If you encounter a clear bug, please file a minimal reproducible example on <a href="https://github.com/TiagoOlivoto/metan/issues">github</a></p></li>
</ul>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-Alves2018">
<p>Alves, Rodrigo Silva, Leonardo de Azevedo Peixoto, Paulo Eduardo Teodoro, Lidiane Aparecida Silva, Erina Vitório Rodrigues, Marcos Deon Vilela de Resende, Bruno Galveas Laviola, and Leonardo Lopes Bhering. 2018. “Selection of Jatropha curcas families based on temporal stability and adaptability of genetic values.” <em>Industrial Crops and Products</em> 119 (September): 290–93. <a href="https://doi.org/10.1016/J.INDCROP.2018.04.029">https://doi.org/10.1016/J.INDCROP.2018.04.029</a>.</p>
</div>
<div id="ref-Annicchiarico1992">
<p>Annicchiarico, P. 1992. “Cultivar adaptation and recommendation from alfalfa trials in Northern Italy.” <em>Journal of Genetics and Breeding</em> 46: 269–78.</p>
</div>
<div id="ref-Eberhart1966">
<p>Eberhart, S. A., and W. A. Russell. 1966. “Stability parameters for comparing Varieties.” <em>Crop Science</em> 6 (1): 36–40. <a href="https://doi.org/10.2135/cropsci1966.0011183X000600010011x">https://doi.org/10.2135/cropsci1966.0011183X000600010011x</a>.</p>
</div>
<div id="ref-Lin1988">
<p>Lin, C. S., and M. R. Binns. 1988. “A superiority measure of cultivar performance for cultivar x location data.” <em>Canadian Journal of Plant Science</em> 68 (1): 193–98. <a href="https://doi.org/10.4141/cjps88-018">https://doi.org/10.4141/cjps88-018</a>.</p>
</div>
<div id="ref-murakami2004">
<p>Murakami, D. M., and C. D. Cruz. 2004. “Proposal of methodologies for environment stratification and analysis of genotype adaptability.” <em>Crop Breeding and Applied Biotechnology</em> 4 (1): 7–11. <a href="http://www.sbmp.org.br/cbab/siscbab/uploads/c8128f42-aefe-cdf5.pdf">http://www.sbmp.org.br/cbab/siscbab/uploads/c8128f42-aefe-cdf5.pdf</a>.</p>
</div>
<div id="ref-Olivoto2019">
<p>Olivoto, T., A. D. C Lúcio, J. A. G. Da silva, V. S. Marchioro, V. Q. de Souza, and E. Jost. 2019. “Mean performance and stability in multi-environment trials I: Combining features of AMMI and BLUP techniques.” <em>Agronomy Journal</em>.</p>
</div>
<div id="ref-Olivoto2019a">
<p>Olivoto, T., A. D. C Lúcio, J. A. G. Da silva, B. G. Sari, and M. I. Diel. 2019. “Mean performance and stability in multi-environment trials II: Selection based on multiple traits.” <em>Agronomy Journal</em>.</p>
</div>
<div id="ref-Wricke1965">
<p>Wricke, G. 1965. “Zur berechnung der okovalenz bei sommerweizen und hafer.” <em>Z. Pflanzenzuchtg</em> 52: 127–38.</p>
</div>
<div id="ref-Yan2003">
<p>Yan, Weikai., and Manjit S. Kang. 2003. <em>GGE biplot analysis : a graphical tool for breeders, geneticists, and agronomists</em>. CRC Press.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#brief-examples">Brief examples</a></li>
      <li>
<a href="#ammi-model">AMMI model</a><ul class="nav nav-pills nav-stacked">
<li><a href="#cross-validation-procedures">Cross-validation procedures</a></li>
      </ul>
</li>
      <li>
<a href="#blup-model">BLUP model</a><ul class="nav nav-pills nav-stacked">
<li><a href="#residual-plots">Residual plots</a></li>
      <li><a href="#distribution-of-random-effects">Distribution of random effects</a></li>
      <li><a href="#plotting-the-blups-for-genotypes">Plotting the BLUPs for genotypes</a></li>
      <li><a href="#blups-for-genotype-vs-environment-interaction">BLUPS for genotype-vs-environment interaction</a></li>
      <li><a href="#blup-based-stability-index">BLUP-based stability index</a></li>
      </ul>
</li>
      <li>
<a href="#gge-model">GGE model</a><ul class="nav nav-pills nav-stacked">
<li><a href="#fitting-the-model-1">Fitting the model</a></li>
      <li><a href="#visualizing-the-biplot">Visualizing the Biplot</a></li>
      </ul>
</li>
      <li><a href="#parametric-and-non-parametric-statistics">Parametric and non-parametric statistics</a></li>
      <li><a href="#computing-the-indexes">Computing the indexes</a></li>
      <li><a href="#selection-based-on-multiple-traits">Selection based on multiple traits</a></li>
      <li><a href="#getting-help">Getting help</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://www.researchgate.net/profile/Tiago_Olivoto2">Tiago Olivoto</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'ef40e3bab94bb0e1d687fd3844052701',
    indexName: 'metan',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
