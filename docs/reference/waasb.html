<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Weighted Average of Absolute Scores — waasb • metan</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>



<meta property="og:title" content="Weighted Average of Absolute Scores — waasb" />
<meta property="og:description" content="Compute the Weighted Average of Absolute Scores for quantifying the stability
in multi-environment trials using mixed-effect models (Olivoto et al., 2019)." />
<meta property="og:image" content="https://tiagoolivoto.github.io/metan/logo.png" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-140429633-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-140429633-1');
</script>


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">metan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/vignettes_cross-validation.html">Cross-validation</a>
    </li>
    <li>
      <a href="../articles/vignettes_ammi.html">AMMI</a>
    </li>
    <li>
      <a href="../articles/vignettes_blup.html">BLUP</a>
    </li>
    <li>
      <a href="../articles/vignettes_gge.html">GGE</a>
    </li>
    <li>
      <a href="../articles/vignettes_stability.html">Stability</a>
    </li>
    <li>
      <a href="../articles/vignettes_indexes.html">Multivariate indexes</a>
    </li>
    <li>
      <a href="../articles/vignettes_biometry.html">Biometry</a>
    </li>
    <li>
      <a href="../articles/vignettes_helper.html">Helper</a>
    </li>
    <li>
      <a href="../articles/vignettes_utilities.html">Utilities</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    More
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../CODE_OF_CONDUCT.html">Code of Conduct</a>
    </li>
    <li>
      <a href="../CONTRIBUTING.html">Contributing</a>
    </li>
    <li>
      <a href="../ISSUE_TEMPLATE.html">Issues</a>
    </li>
    <li>
      <a href="../SUPPORT.html">Support</a>
    </li>
    <li>
      <a href="../LICENSE.html">Licence</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/TiagoOlivoto">Github</a>
</li>
<li>
  <a href="https://www.researchgate.net/profile/Tiago_Olivoto2">ResearchGate</a>
</li>
<li>
  <a href="https://www.mendeley.com/profiles/tiago-olivoto/">Mendeley</a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Weighted Average of Absolute Scores</h1>
    <small class="dont-index">Source: <a href='https://github.com/TiagoOlivoto/metan/blob/master/R/WAASB.R'><code>R/WAASB.R</code></a></small>
    <div class="hidden name"><code>waasb.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute the Weighted Average of Absolute Scores for quantifying the stability
in multi-environment trials using mixed-effect models (Olivoto et al., 2019).</p>
    </div>

    <pre class="usage"><span class='fu'>waasb</span>(
  <span class='no'>.data</span>,
  <span class='no'>env</span>,
  <span class='no'>gen</span>,
  <span class='no'>rep</span>,
  <span class='no'>resp</span>,
  <span class='kw'>mresp</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>wresp</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>random</span> <span class='kw'>=</span> <span class='st'>"gen"</span>,
  <span class='kw'>prob</span> <span class='kw'>=</span> <span class='fl'>0.05</span>,
  <span class='kw'>ind_anova</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>.data</th>
      <td><p>The dataset containing the columns related to Environments,
Genotypes, replication/block and response variable(s).</p></td>
    </tr>
    <tr>
      <th>env</th>
      <td><p>The name of the column that contains the levels of the
environments.</p></td>
    </tr>
    <tr>
      <th>gen</th>
      <td><p>The name of the column that contains the levels of the genotypes.</p></td>
    </tr>
    <tr>
      <th>rep</th>
      <td><p>The name of the column that contains the levels of the
replications/blocks.</p></td>
    </tr>
    <tr>
      <th>resp</th>
      <td><p>The response variable(s). To analyze multiple variables in a
single procedure a vector of variables may be used. For example <code>resp
  = c(var1, var2, var3)</code>.</p></td>
    </tr>
    <tr>
      <th>mresp</th>
      <td><p>A numeric vector of the same length of <code>resp</code>. The
<code>mresp</code> will be the new maximum value after rescaling. By default, all
variables in <code>resp</code> are rescaled so that de maximum value is 100 and
the minimum value is 0.</p></td>
    </tr>
    <tr>
      <th>wresp</th>
      <td><p>The weight for the response variable(s) for computing the WAASBY
index. Must be a numeric vector of the same length of <code>resp</code>. Defaults
to 50, i.e., equal weights for stability and mean performance.</p></td>
    </tr>
    <tr>
      <th>random</th>
      <td><p>The effects of the model assumed to be random. Default is
<code>random = "gen"</code> (genotype and genotype-vs-environment as random
effects. Other values allowed are <code>random = "env"</code> (environment,
genotype-vs-environment and block-within-environment random effects) or
<code>random = "all"</code> all effects except the intercept are assumed to be
random effects.</p></td>
    </tr>
    <tr>
      <th>prob</th>
      <td><p>The probability for estimating confidence interval for BLUP's
prediction.</p></td>
    </tr>
    <tr>
      <th>ind_anova</th>
      <td><p>Logical argument set to <code>TRUE</code>. If <code>FALSE</code> the
within-environment ANOVA is not performed.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Logical argument. If <code>verbose = FALSE</code> the code are run
silently.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>waasb</code> with the following items for each
variable: * <strong>individual</strong> A within-environments ANOVA considering a
fixed-effect model.</p><ul>
<li><p><strong>fixed</strong> Test for fixed effects.</p></li>
<li><p><strong>random</strong> Variance components for random effects.</p></li>
<li><p><strong>LRT</strong> The Likelihood Ratio Test for the random effects.</p></li>
<li><p><strong>model</strong> A data frame with the response variable, the scores of all
Principal Components, the estimates of Weighted Average of Absolute Scores,
and WAASY (the index that consider the weights for stability and productivity
in the genotype ranking.</p></li>
<li><p><strong>blupGEN</strong> The estimated BLUPS for genotypes (If <code>random =
"gen"</code> or <code>random = "all"</code>)</p></li>
<li><p><strong>BLUPenv</strong> The estimated BLUPS for environments, (If <code>random =
"env"</code> or <code>random = "all"</code>).</p></li>
<li><p><strong>BLUPge</strong> The estimated BLUPS of all genotypes in all environments
"BLUPij".</p></li>
<li><p><strong>PCA</strong> The results of Principal Component Analysis with eigenvalues
and explained variance of BLUP-interaction matrix.</p></li>
<li><p><strong>MeansGxE</strong> The phenotypic means of genotypes in the environments,
with observed, predicted and OLS residual prediction.</p></li>
<li><p><strong>Details</strong> A list summarizing the results. The following information
are showed. <code>WgtResponse</code>, the weight for the response variable in
estimating WAASB, <code>WgtWAAS</code> the weight for stability, <code>Ngen</code> the
number of genotypes, <code>Nenv</code> the number of environments, <code>OVmean</code>
the overall mean, <code>Min</code> the minimum observed (returning the genotype and
environment), <code>Max</code> the maximum observed, <code>Max</code> the maximum
observed, <code>MinENV</code> the environment with the lower mean, <code>MaxENV</code>
the environment with the larger mean observed, <code>MinGEN</code> the genotype
with the lower mean, <code>MaxGEN</code> the genotype with the larger.</p></li>
<li><p><strong>ESTIMATES</strong> A list with the following values: <code>GEV</code> the
genotype-by-environment variance (and percentage of phenotypic variance);
<code>GV</code> the genotypic variance (and percentage of phenotypic variance);
<code>EV</code> the environmental variance;<code>RV</code> the residual variance (and
percentage of phenotypic variance); <code>FV</code> the phenotypic variance;
<code>h2g</code> the heritability of the trait; <code>GEr2</code> the coefficient of
determination of the interaction effects; <code>h2mg</code> the heritability of the
mean; <code>AccuGen</code> the selective accuracy; <code>rge</code> the
genotype-environment correlation; <code>CVg</code> the genotypic coefficient of
variation; <code>CVr</code> the residual coefficient of variation; <code>CVratio</code>
the ratio between genotypic and residual coefficient of variation *
<strong>residuals</strong> The residuals of the model.</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function compute the weighted average of absolute scores considering all
principal component axis from the Singular Value Decomposition (SVD) of the
BLUP'S GxE effects matrix generated by a linear mixed-effect model.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Olivoto, T., A.D.C. L\'ucio, J.A.G. da silva, V.S. Marchioro,
V.Q. de Souza, and E. Jost. 2019. Mean performance and stability in
multi-environment trials I: Combining features of AMMI and BLUP techniques.
Agron. J.
<a href='https://dl.sciencesocieties.org/publications/aj/abstracts/0/0/agronj2019.03.0220?access=0&amp;view=pdf'>doi:10.2134/agronj2019.03.0220</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='waas.html'>waas</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>metan</span>)

<span class='co'># Genotypes as random effects</span>
<span class='co'># Equal weights for response variable and stability</span>

<span class='no'>model</span> <span class='kw'>&lt;-</span> <span class='fu'>waasb</span>(<span class='no'>data_ge</span>,
              <span class='kw'>env</span> <span class='kw'>=</span> <span class='no'>ENV</span>,
              <span class='kw'>gen</span> <span class='kw'>=</span> <span class='no'>GEN</span>,
              <span class='kw'>rep</span> <span class='kw'>=</span> <span class='no'>REP</span>,
              <span class='kw'>resp</span> <span class='kw'>=</span> <span class='no'>GY</span>)</div><div class='output co'>#&gt; All variables with significant (p &lt; 0.05) genotype-vs-environment interaction
#&gt; Done!</div><div class='input'>
<span class='co'># Higher weight for response variable</span>

<span class='no'>model2</span> <span class='kw'>&lt;-</span> <span class='fu'>waasb</span>(<span class='no'>data_ge</span>,
               <span class='kw'>env</span> <span class='kw'>=</span> <span class='no'>ENV</span>,
               <span class='kw'>gen</span> <span class='kw'>=</span> <span class='no'>GEN</span>,
               <span class='kw'>rep</span> <span class='kw'>=</span> <span class='no'>REP</span>,
               <span class='kw'>resp</span> <span class='kw'>=</span> <span class='no'>GY</span>,
               <span class='kw'>wresp</span> <span class='kw'>=</span> <span class='fl'>65</span>)</div><div class='output co'>#&gt; All variables with significant (p &lt; 0.05) genotype-vs-environment interaction
#&gt; Done!</div><div class='input'>
<span class='co'># Environment as random effects analyzing more than one variable</span>
<span class='co'># Smaller values of HM are better and higher</span>
<span class='co'># Higher values of GY are better</span>
<span class='co'># Larger weight for the GY (60%)</span>
<span class='co'># Smaller weight for HM (40%)</span>

<span class='no'>model3</span> <span class='kw'>&lt;-</span> <span class='fu'>waasb</span>(<span class='no'>data_ge</span>,
                <span class='kw'>env</span> <span class='kw'>=</span> <span class='no'>ENV</span>,
                <span class='kw'>gen</span> <span class='kw'>=</span> <span class='no'>GEN</span>,
                <span class='kw'>rep</span> <span class='kw'>=</span> <span class='no'>REP</span>,
                <span class='kw'>resp</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>GY</span>, <span class='no'>HM</span>),
                <span class='kw'>random</span> <span class='kw'>=</span> <span class='st'>"env"</span>,
                <span class='kw'>mresp</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>100</span>, <span class='fl'>0</span>),
                <span class='kw'>wresp</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>60</span>, <span class='fl'>40</span>))</div><div class='output co'>#&gt; Evaluating variable GY 0 % 
#&gt; Evaluating variable HM 100 % 
#&gt; All variables with significant (p &lt; 0.05) genotype-vs-environment interaction
#&gt; Done!</div><div class='input'># }

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Tiago Olivoto <a href='mailto:tiagoolivoto@gmail.com'>tiagoolivoto@gmail.com</a></p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://www.researchgate.net/profile/Tiago_Olivoto2'>Tiago Olivoto</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: 'ef40e3bab94bb0e1d687fd3844052701',
    indexName: 'metan',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


