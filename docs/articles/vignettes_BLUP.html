<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Analyzing multienvironment trials using BLUP • METAAB</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Analyzing multienvironment trials using BLUP">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">METAAB</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a>
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vignettes_CROSS-VALIDATION.html">Cross-validation procedure</a>
    </li>
    <li>
      <a href="../articles/vignettes_AMMI.html">AMMI</a>
    </li>
    <li>
      <a href="../articles/vignettes_BLUP.html">BLUP</a>
    </li>
    <li>
      <a href="../articles/vignettes_INDEXES.html">Multivariate indexes</a>
    </li>
    <li>
      <a href="../articles/vignettes_BIOMETRY.html">Biometry</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    More
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../CODE_OF_CONDUCT.html">Code of Conduct</a>
    </li>
    <li>
      <a href="../news/index.html">News</a>
    </li>
    <li>
      <a href="../LICENSE.html">Licence</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://www.researchgate.net/profile/Tiago_Olivoto2">ResearchGate</a>
</li>
<li>
  <a href="https://www.mendeley.com/profiles/tiago-olivoto/">Mendeley</a>
</li>
<li>
  <a href="https://github.com/TiagoOlivoto">Github</a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><script src="vignettes_BLUP_files/kePrint-0.0.1/kePrint.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Analyzing multienvironment trials using BLUP</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/TiagoOlivoto/METAAB/blob/master/vignettes/vignettes_BLUP.Rmd"><code>vignettes/vignettes_BLUP.Rmd</code></a></small>
      <div class="hidden name"><code>vignettes_BLUP.Rmd</code></div>

    </div>

    
    
<div id="getting-started" class="section level1">
<h1 class="hasAnchor">
<a href="#getting-started" class="anchor"></a>Getting started</h1>
<p>A dataset called <code>data_ge</code> is provided to make reproducible examples. For more information, please, see <code><a href="../reference/data_ge.html">?data_ge</a></code>. Other data sets can be used provided that the following columns are in the dataset: environment, genotype, block/replicate and response variable(s).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Importing data</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(METAAB)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(cowplot)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(kableExtra)
dataset =<span class="st"> </span>data_ge</code></pre></div>
</div>
<div id="estimating-the-waasb-based-on-svd-of-blup-interaction-effects" class="section level1">
<h1 class="hasAnchor">
<a href="#estimating-the-waasb-based-on-svd-of-blup-interaction-effects" class="anchor"></a>Estimating the WAASB (based on SVD of BLUP-interaction effects)</h1>
<p>The <code><a href="../reference/WAASB.html">WAASB()</a></code> function computes the weighted average of absolute scores considering all possible IPCA from the Singular Value Decomposition of the BLUPs for genotype-vs-environment interaction effects obtained by an Linear Mixed-effect Model, as follows:</p>
<p><span class="math display">\[
        WAASB_i  = 
        \sum_{k = 1}^{p} |IPCA_{ik} \times EP_k|/ \sum_{k = 1}^{p}EP_k
\]</span></p>
<p>where <span class="math inline">\(WAASB_i\)</span> is the weighted average of absolute scores of the <em>i</em>th genotype; <span class="math inline">\(IPCA_{ik}\)</span> is the scores of the <em>i</em>th genotype in the <em>k</em>th IPCA; and <span class="math inline">\(EP_k\)</span> is the explained variance of the <em>k</em>th PCA for <span class="math inline">\(k = 1,2,..,p\)</span>, <span class="math inline">\(p = min(G-1;E-1)\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Assuming equal weights for productivity and stability (default)</span>
WAASB =<span class="st"> </span><span class="kw"><a href="../reference/WAASB.html">WAASB</a></span>(dataset,
              <span class="dt">resp =</span> GY,
              <span class="dt">gen =</span> GEN,
              <span class="dt">env =</span> ENV,
              <span class="dt">rep =</span> REP)</code></pre></div>
<pre><code>## Done!</code></pre>
<div id="diagnostic-plot-for-residuals" class="section level2">
<h2 class="hasAnchor">
<a href="#diagnostic-plot-for-residuals" class="anchor"></a>Diagnostic plot for residuals</h2>
<p>The function <code>autoplot()</code> is used to generate diagnostic plots of residuals of the model. The normality of the random effects of genotype and interaction effects may be also obtained by using <code>type = "re"</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)
<span class="kw">autoplot</span>(WAASB<span class="op">$</span>GY)</code></pre></div>
<p><img src="vignettes_BLUP_files/figure-html/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div id="printing-the-model-outputs" class="section level2">
<h2 class="hasAnchor">
<a href="#printing-the-model-outputs" class="anchor"></a>Printing the model outputs</h2>
<div id="likelihood-ratio-tests" class="section level3">
<h3 class="hasAnchor">
<a href="#likelihood-ratio-tests" class="anchor"></a>Likelihood Ratio Tests</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/options">options</a></span>(<span class="dt">digits =</span> <span class="dv">5</span>)
data =<span class="st"> </span>WAASB<span class="op">$</span>GY<span class="op">$</span>LRT
<span class="kw">kable</span>(data, <span class="st">"html"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="st">"striped"</span>, <span class="st">"condensed"</span>,
                <span class="dt">position =</span> <span class="st">"left"</span>, <span class="dt">full_width =</span> F, <span class="dt">font_size =</span> <span class="dv">12</span>)</code></pre></div>
<table class="table table table-striped">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
npar
</th>
<th style="text-align:right;">
logLik
</th>
<th style="text-align:right;">
AIC
</th>
<th style="text-align:right;">
LRT
</th>
<th style="text-align:right;">
Df
</th>
<th style="text-align:right;">
Pr(&gt;Chisq)
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Complete
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
-214.72
</td>
<td style="text-align:right;">
519.43
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Genotype
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
-224.37
</td>
<td style="text-align:right;">
536.75
</td>
<td style="text-align:right;">
19.315
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1e-05
</td>
</tr>
<tr>
<td style="text-align:left;">
Gen vs Env
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
-237.13
</td>
<td style="text-align:right;">
562.27
</td>
<td style="text-align:right;">
44.832
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0e+00
</td>
</tr>
</tbody>
</table>
<p>The output <code>LRT</code> contains the Likelihood Ratio Tests for genotype and genotype-vs-environment random effects.</p>
</div>
<div id="variance-components-and-genetic-parameters" class="section level3">
<h3 class="hasAnchor">
<a href="#variance-components-and-genetic-parameters" class="anchor"></a>Variance components and genetic parameters</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/options">options</a></span>(<span class="dt">digits =</span> <span class="dv">7</span>)
data =<span class="st"> </span>WAASB<span class="op">$</span>GY<span class="op">$</span>ESTIMATES
<span class="kw">kable</span>(data, <span class="st">"html"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="st">"striped"</span>, <span class="st">"condensed"</span>,
                <span class="dt">position =</span> <span class="st">"left"</span>, <span class="dt">full_width =</span> F, <span class="dt">font_size =</span> <span class="dv">12</span>)</code></pre></div>
<table class="table table table-striped">
<thead><tr>
<th style="text-align:left;">
Parameters
</th>
<th style="text-align:left;">
Values
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
GEI variance
</td>
<td style="text-align:left;">
0.056714 (31.26% of phenotypic variance.)
</td>
</tr>
<tr>
<td style="text-align:left;">
Genotypic variance
</td>
<td style="text-align:left;">
0.028025 (15.45% of phenotypic variance.)
</td>
</tr>
<tr>
<td style="text-align:left;">
Residual variance
</td>
<td style="text-align:left;">
0.096693 (53.29% of phenotypic variance.)
</td>
</tr>
<tr>
<td style="text-align:left;">
Phenotypic variance
</td>
<td style="text-align:left;">
0.181432000765268
</td>
</tr>
<tr>
<td style="text-align:left;">
Heritability
</td>
<td style="text-align:left;">
0.154466820776706
</td>
</tr>
<tr>
<td style="text-align:left;">
GEIr2
</td>
<td style="text-align:left;">
0.31258908175788
</td>
</tr>
<tr>
<td style="text-align:left;">
Heribatility of means
</td>
<td style="text-align:left;">
0.815198214388929
</td>
</tr>
<tr>
<td style="text-align:left;">
Accuracy
</td>
<td style="text-align:left;">
0.902883278385932
</td>
</tr>
<tr>
<td style="text-align:left;">
rge
</td>
<td style="text-align:left;">
0.369694636992275
</td>
</tr>
<tr>
<td style="text-align:left;">
CVg
</td>
<td style="text-align:left;">
6.25999359149609
</td>
</tr>
<tr>
<td style="text-align:left;">
CVr
</td>
<td style="text-align:left;">
11.6277882108427
</td>
</tr>
<tr>
<td style="text-align:left;">
CV ratio
</td>
<td style="text-align:left;">
0.53836494765692
</td>
</tr>
</tbody>
</table>
<p>In the output <code>ESTIMATES</code>, beyond the variance components for the declared random effects, some important parameters are also shown. <strong>Heribatility</strong> is the broad-sense heritability, <span class="math inline">\(\mathop h\nolimits_g^2\)</span>, estimated by <span class="math inline">\(\mathop h\nolimits_g^2 = \mathop {\hat\sigma} \nolimits_g^2 /\left( {\mathop {\hat\sigma} \nolimits_g^2 + \mathop {\hat\sigma} \nolimits_i^2 + \mathop {\hat\sigma} \nolimits_e^2 } \right)\)</span> where <span class="math inline">\(\mathop {\hat\sigma} \nolimits_g^2\)</span> is the genotypic variance; <span class="math inline">\(\mathop {\hat\sigma} \nolimits_i^2\)</span> is the genotype-by-environment interaction variance; and <span class="math inline">\(\mathop {\hat\sigma} \nolimits_e^2\)</span> is the residual variance. <strong>GEIr2</strong> is the coefficient of determination of the interaction effects, <span class="math inline">\(\mathop r\nolimits_i^2\)</span>, estimated by <span class="math inline">\(\mathop r\nolimits_i^2 = \mathop {\hat\sigma} \nolimits_i^2 /\left( {\mathop {\hat\sigma} \nolimits_g^2 + \mathop {\hat\sigma} \nolimits_i^2 + \mathop {\hat\sigma} \nolimits_e^2 } \right)\)</span>; <strong>Heribatility of means</strong> is the heribability on the mean basis, <span class="math inline">\(\mathop h\nolimits_{gm}^2\)</span>, estimated by <span class="math inline">\(\mathop h\nolimits_{gm}^2 = \mathop {\hat\sigma} \nolimits_g^2 /\left[ {\mathop {\hat\sigma} \nolimits_g^2 + \mathop {\hat\sigma} \nolimits_i^2 /e + \mathop {\hat\sigma} \nolimits_e^2 /\left( {eb} \right)} \right]\)</span>, where <em>e</em> and <em>b</em> are the number of environments and blocks, respectively; <strong>Accuracy</strong> is the accuracy of selection, <em>Ac</em>, estimated by <span class="math inline">\(Ac = \sqrt{\mathop h\nolimits_{gm}^2}\)</span> ; <strong>rge</strong> is the genotype-environment correlation, <span class="math inline">\(\mathop r\nolimits_{ge}\)</span>, estimated by <span class="math inline">\(\mathop r\nolimits_{ge} = \mathop {\hat\sigma} \nolimits_g^2 /\left({\mathop {\hat\sigma} \nolimits_g^2 + \mathop {\hat\sigma} \nolimits_i^2} \right)\)</span>; <strong>CVg</strong> is the the genotypic coefficient of variation, estimated by <span class="math inline">\(\left( {\sqrt {\mathop {\hat \sigma }\nolimits_g^2 } /\mu } \right) \times 100\)</span> , where <span class="math inline">\(\mu\)</span> is the grand mean; <strong>CVr</strong> is the residual coefficient of variation, estimated by <span class="math inline">\(\left( {\sqrt {\mathop {\hat \sigma }\nolimits_e^2 } /\mu } \right) \times 100\)</span> ; <strong>CV ratio</strong> is the ratio between genotypic and residual coefficient of variation.</p>
</div>
<div id="some-useful-information" class="section level3">
<h3 class="hasAnchor">
<a href="#some-useful-information" class="anchor"></a>Some useful information</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/options">options</a></span>(<span class="dt">digits =</span> <span class="dv">4</span>)
data =<span class="st"> </span>WAASB<span class="op">$</span>GY<span class="op">$</span>Details
<span class="kw">kable</span>(data, <span class="st">"html"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="st">"striped"</span>, <span class="st">"condensed"</span>,
                <span class="dt">position =</span> <span class="st">"left"</span>, <span class="dt">full_width =</span> F, <span class="dt">font_size =</span> <span class="dv">12</span>)</code></pre></div>
<table class="table table table-striped">
<thead><tr>
<th style="text-align:left;">
Parameters
</th>
<th style="text-align:left;">
Values
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Ngen
</td>
<td style="text-align:left;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
Nenv
</td>
<td style="text-align:left;">
14
</td>
</tr>
<tr>
<td style="text-align:left;">
OVmean
</td>
<td style="text-align:left;">
2.6742
</td>
</tr>
<tr>
<td style="text-align:left;">
Min
</td>
<td style="text-align:left;">
0.8991 (Genotype G10 in E11 )
</td>
</tr>
<tr>
<td style="text-align:left;">
Max
</td>
<td style="text-align:left;">
4.8121 (Genotype G8 in E5 )
</td>
</tr>
<tr>
<td style="text-align:left;">
MinENV
</td>
<td style="text-align:left;">
Environment E11 (1.3683)
</td>
</tr>
<tr>
<td style="text-align:left;">
MaxENV
</td>
<td style="text-align:left;">
Environment E3 (4.0643)
</td>
</tr>
<tr>
<td style="text-align:left;">
MinGEN
</td>
<td style="text-align:left;">
Genotype G10 (2.4712)
</td>
</tr>
<tr>
<td style="text-align:left;">
MaxGEN
</td>
<td style="text-align:left;">
Genotype G8 (3.0036)
</td>
</tr>
</tbody>
</table>
<p>The following pieces of information are provided in <code>Details</code> output. <strong>WgtResponse</strong> is the weight for the response variable in estimating WAASB; <strong>WgtWAAS</strong> is the weight for stability; <strong>Ngen</strong> is the number of genotypes; <strong>Nenv</strong> is the number of environments; <strong>OVmean</strong> is the overall mean; <strong>Min</strong> is the minimum value observed (returning the genotype and environment); <strong>Max</strong> is the maximum observed; <strong>MinENV</strong> is the environment with the lower mean; <strong>MaxENV</strong> is the environment with the largest mean observed; <strong>MinGEN</strong> is the genotype with the lower mean; <strong>MaxGEN</strong> is the genotype with the largest mean.</p>
</div>
<div id="the-waasb-object" class="section level3">
<h3 class="hasAnchor">
<a href="#the-waasb-object" class="anchor"></a>The WAASB object</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/options">options</a></span>(<span class="dt">digits =</span> <span class="dv">4</span>)
data =<span class="st"> </span>WAASB<span class="op">$</span>GY<span class="op">$</span>model[, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="dv">13</span><span class="op">:</span><span class="dv">17</span>, <span class="dv">21</span><span class="op">:</span><span class="dv">22</span>)]
<span class="kw">kable</span>(data, <span class="st">"html"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="st">"striped"</span>, <span class="st">"condensed"</span>,
                <span class="dt">position =</span> <span class="st">"left"</span>, <span class="dt">full_width =</span> F, <span class="dt">font_size =</span> <span class="dv">12</span>)</code></pre></div>
<table class="table table table-striped">
<thead><tr>
<th style="text-align:left;">
type
</th>
<th style="text-align:left;">
Code
</th>
<th style="text-align:right;">
Y
</th>
<th style="text-align:right;">
WAASB
</th>
<th style="text-align:right;">
PctResp
</th>
<th style="text-align:right;">
PctWAASB
</th>
<th style="text-align:right;">
OrResp
</th>
<th style="text-align:right;">
OrWAASB
</th>
<th style="text-align:right;">
WAASBY
</th>
<th style="text-align:right;">
OrWAASBY
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
GEN
</td>
<td style="text-align:left;">
G1
</td>
<td style="text-align:right;">
2.604
</td>
<td style="text-align:right;">
0.1341
</td>
<td style="text-align:right;">
24.878
</td>
<td style="text-align:right;">
90.37
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
57.62
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
GEN
</td>
<td style="text-align:left;">
G10
</td>
<td style="text-align:right;">
2.471
</td>
<td style="text-align:right;">
0.4646
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
GEN
</td>
<td style="text-align:left;">
G2
</td>
<td style="text-align:right;">
2.744
</td>
<td style="text-align:right;">
0.2138
</td>
<td style="text-align:right;">
51.262
</td>
<td style="text-align:right;">
68.57
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
59.92
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
GEN
</td>
<td style="text-align:left;">
G3
</td>
<td style="text-align:right;">
2.955
</td>
<td style="text-align:right;">
0.0989
</td>
<td style="text-align:right;">
90.929
</td>
<td style="text-align:right;">
100.00
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
95.46
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
GEN
</td>
<td style="text-align:left;">
G4
</td>
<td style="text-align:right;">
2.642
</td>
<td style="text-align:right;">
0.2475
</td>
<td style="text-align:right;">
32.060
</td>
<td style="text-align:right;">
59.36
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
45.71
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:left;">
GEN
</td>
<td style="text-align:left;">
G5
</td>
<td style="text-align:right;">
2.537
</td>
<td style="text-align:right;">
0.2178
</td>
<td style="text-align:right;">
12.419
</td>
<td style="text-align:right;">
67.49
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
39.95
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:left;">
GEN
</td>
<td style="text-align:left;">
G6
</td>
<td style="text-align:right;">
2.534
</td>
<td style="text-align:right;">
0.1721
</td>
<td style="text-align:right;">
11.797
</td>
<td style="text-align:right;">
79.98
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
45.89
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
GEN
</td>
<td style="text-align:left;">
G7
</td>
<td style="text-align:right;">
2.741
</td>
<td style="text-align:right;">
0.3190
</td>
<td style="text-align:right;">
50.654
</td>
<td style="text-align:right;">
39.80
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
45.23
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:left;">
GEN
</td>
<td style="text-align:left;">
G8
</td>
<td style="text-align:right;">
3.004
</td>
<td style="text-align:right;">
0.2649
</td>
<td style="text-align:right;">
100.000
</td>
<td style="text-align:right;">
54.61
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
77.30
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
GEN
</td>
<td style="text-align:left;">
G9
</td>
<td style="text-align:right;">
2.510
</td>
<td style="text-align:right;">
0.3720
</td>
<td style="text-align:right;">
7.320
</td>
<td style="text-align:right;">
25.32
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
16.32
</td>
<td style="text-align:right;">
9
</td>
</tr>
<tr>
<td style="text-align:left;">
ENV
</td>
<td style="text-align:left;">
E1
</td>
<td style="text-align:right;">
2.521
</td>
<td style="text-align:right;">
0.1799
</td>
<td style="text-align:right;">
42.744
</td>
<td style="text-align:right;">
73.77
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
58.26
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
ENV
</td>
<td style="text-align:left;">
E10
</td>
<td style="text-align:right;">
2.175
</td>
<td style="text-align:right;">
0.1904
</td>
<td style="text-align:right;">
29.930
</td>
<td style="text-align:right;">
70.49
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
50.21
</td>
<td style="text-align:right;">
9
</td>
</tr>
<tr>
<td style="text-align:left;">
ENV
</td>
<td style="text-align:left;">
E11
</td>
<td style="text-align:right;">
1.368
</td>
<td style="text-align:right;">
0.1165
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
93.47
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
46.74
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:left;">
ENV
</td>
<td style="text-align:left;">
E12
</td>
<td style="text-align:right;">
1.609
</td>
<td style="text-align:right;">
0.1888
</td>
<td style="text-align:right;">
8.911
</td>
<td style="text-align:right;">
71.00
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
39.96
</td>
<td style="text-align:right;">
13
</td>
</tr>
<tr>
<td style="text-align:left;">
ENV
</td>
<td style="text-align:left;">
E13
</td>
<td style="text-align:right;">
2.910
</td>
<td style="text-align:right;">
0.2835
</td>
<td style="text-align:right;">
57.171
</td>
<td style="text-align:right;">
41.55
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
49.36
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
ENV
</td>
<td style="text-align:left;">
E14
</td>
<td style="text-align:right;">
1.782
</td>
<td style="text-align:right;">
0.1360
</td>
<td style="text-align:right;">
15.343
</td>
<td style="text-align:right;">
87.43
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
51.39
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:left;">
ENV
</td>
<td style="text-align:left;">
E2
</td>
<td style="text-align:right;">
3.180
</td>
<td style="text-align:right;">
0.1806
</td>
<td style="text-align:right;">
67.198
</td>
<td style="text-align:right;">
73.55
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
70.37
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
ENV
</td>
<td style="text-align:left;">
E3
</td>
<td style="text-align:right;">
4.064
</td>
<td style="text-align:right;">
0.2122
</td>
<td style="text-align:right;">
100.000
</td>
<td style="text-align:right;">
63.72
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
81.86
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
ENV
</td>
<td style="text-align:left;">
E4
</td>
<td style="text-align:right;">
3.675
</td>
<td style="text-align:right;">
0.3207
</td>
<td style="text-align:right;">
85.569
</td>
<td style="text-align:right;">
29.97
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
57.77
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:left;">
ENV
</td>
<td style="text-align:left;">
E5
</td>
<td style="text-align:right;">
3.910
</td>
<td style="text-align:right;">
0.2410
</td>
<td style="text-align:right;">
94.294
</td>
<td style="text-align:right;">
54.76
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
74.53
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
ENV
</td>
<td style="text-align:left;">
E6
</td>
<td style="text-align:right;">
2.663
</td>
<td style="text-align:right;">
0.0955
</td>
<td style="text-align:right;">
48.031
</td>
<td style="text-align:right;">
100.00
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
74.02
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
ENV
</td>
<td style="text-align:left;">
E7
</td>
<td style="text-align:right;">
1.989
</td>
<td style="text-align:right;">
0.1997
</td>
<td style="text-align:right;">
23.020
</td>
<td style="text-align:right;">
67.61
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
45.32
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:left;">
ENV
</td>
<td style="text-align:left;">
E8
</td>
<td style="text-align:right;">
2.536
</td>
<td style="text-align:right;">
0.2034
</td>
<td style="text-align:right;">
43.327
</td>
<td style="text-align:right;">
66.47
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
54.90
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:left;">
ENV
</td>
<td style="text-align:left;">
E9
</td>
<td style="text-align:right;">
3.057
</td>
<td style="text-align:right;">
0.4171
</td>
<td style="text-align:right;">
62.622
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
31.31
</td>
<td style="text-align:right;">
14
</td>
</tr>
</tbody>
</table>
<p>This output generated by the <code>WAASB</code> function is very similar to those shown in the <a href="#assuming-a-given-probability-error-for-chosing-the-number-of-axes">sections 5.1</a> and <a href="#declaring-a-specific-number-of-axis-to-be-used">5.2</a>. The main difference here, is that the singular value decomposition is based on the BLUP interaction effect matrix and the <strong>WAASB</strong> in this output is the weighted average of the absolute scores, estimated with all estimated PCA axes, where instead <strong>WAAS</strong> that is estimated considering only PCA axes with <em>P</em>-value <span class="math inline">\(\le\)</span> 0.05.</p>
</div>
<div id="blup-for-genotypes" class="section level3">
<h3 class="hasAnchor">
<a href="#blup-for-genotypes" class="anchor"></a>BLUP for genotypes</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/options">options</a></span>(<span class="dt">digits =</span> <span class="dv">4</span>)
data =<span class="st"> </span>WAASB<span class="op">$</span>GY<span class="op">$</span>blupGEN[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,]
<span class="kw">kable</span>(data, <span class="st">"html"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="st">"striped"</span>, <span class="st">"condensed"</span>,
                <span class="dt">position =</span> <span class="st">"left"</span>, <span class="dt">full_width =</span> F, <span class="dt">font_size =</span> <span class="dv">12</span>)</code></pre></div>
<table class="table table table-striped">
<thead><tr>
<th style="text-align:right;">
Rank
</th>
<th style="text-align:left;">
GEN
</th>
<th style="text-align:right;">
BLUPg
</th>
<th style="text-align:right;">
Predicted
</th>
<th style="text-align:right;">
LL
</th>
<th style="text-align:right;">
UL
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
G8
</td>
<td style="text-align:right;">
0.2685
</td>
<td style="text-align:right;">
2.943
</td>
<td style="text-align:right;">
2.839
</td>
<td style="text-align:right;">
3.046
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
G3
</td>
<td style="text-align:right;">
0.2292
</td>
<td style="text-align:right;">
2.903
</td>
<td style="text-align:right;">
2.800
</td>
<td style="text-align:right;">
3.007
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
G2
</td>
<td style="text-align:right;">
0.0570
</td>
<td style="text-align:right;">
2.731
</td>
<td style="text-align:right;">
2.628
</td>
<td style="text-align:right;">
2.835
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
G7
</td>
<td style="text-align:right;">
0.0543
</td>
<td style="text-align:right;">
2.729
</td>
<td style="text-align:right;">
2.625
</td>
<td style="text-align:right;">
2.832
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
G4
</td>
<td style="text-align:right;">
-0.0264
</td>
<td style="text-align:right;">
2.648
</td>
<td style="text-align:right;">
2.544
</td>
<td style="text-align:right;">
2.751
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
G1
</td>
<td style="text-align:right;">
-0.0575
</td>
<td style="text-align:right;">
2.617
</td>
<td style="text-align:right;">
2.513
</td>
<td style="text-align:right;">
2.720
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
G5
</td>
<td style="text-align:right;">
-0.1116
</td>
<td style="text-align:right;">
2.563
</td>
<td style="text-align:right;">
2.459
</td>
<td style="text-align:right;">
2.666
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
G6
</td>
<td style="text-align:right;">
-0.1143
</td>
<td style="text-align:right;">
2.560
</td>
<td style="text-align:right;">
2.456
</td>
<td style="text-align:right;">
2.663
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
G9
</td>
<td style="text-align:right;">
-0.1337
</td>
<td style="text-align:right;">
2.541
</td>
<td style="text-align:right;">
2.437
</td>
<td style="text-align:right;">
2.644
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
G10
</td>
<td style="text-align:right;">
-0.1655
</td>
<td style="text-align:right;">
2.509
</td>
<td style="text-align:right;">
2.405
</td>
<td style="text-align:right;">
2.612
</td>
</tr>
</tbody>
</table>
</div>
<div id="plotting-the-blup-for-genotypes" class="section level3">
<h3 class="hasAnchor">
<a href="#plotting-the-blup-for-genotypes" class="anchor"></a>Plotting the BLUP for genotypes</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># No file exported</span>
p1 =<span class="st"> </span><span class="kw"><a href="../reference/plot.blup.html">plot.blup</a></span>(WAASB<span class="op">$</span>GY)
p2 =<span class="st"> </span><span class="kw"><a href="../reference/plot.blup.html">plot.blup</a></span>(WAASB<span class="op">$</span>GY, 
               <span class="dt">col.shape  =</span>  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"gray20"</span>, <span class="st">"gray80"</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>()
<span class="kw">plot_grid</span>(p1, p2,
          <span class="dt">labels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"p1"</span>, <span class="st">"p2"</span>))</code></pre></div>
<p><img src="vignettes_BLUP_files/figure-html/unnamed-chunk-9-1.png" width="960" style="display: block; margin: auto;"></p>
<p>This output shows the predicted means for genotypes. <strong>BLUPg</strong> is the genotypic effect <span class="math inline">\((\hat{g}_{i})\)</span> estimated by <span class="math inline">\(\hat{g}_{i} = h_g^2(\bar{y}_{i.}-\bar{y}_{..})\)</span> where <span class="math inline">\(h_g^2\)</span> is the shrinkage effect for genotype. <strong>Predicted</strong> is the predicted mean estimated by <span class="math inline">\(\hat{g}_{i}+\mu\)</span> where <span class="math inline">\(\mu\)</span> is the grand mean. <strong>LL</strong> and <strong>UL</strong> are the lower and upper limits, respectively, estimated by <span class="math inline">\((\hat{g}_{i}+\mu)\pm{CI}\)</span>. <span class="math inline">\(CI\)</span> is the confidence interval for BLUP prediction assuming a given probability error, where <span class="math inline">\(CI = t\times\sqrt{((1-Ac)\times{\mathop \sigma \nolimits_g^2)}}\)</span> where <span class="math inline">\(t\)</span> is the Student’s <em>t</em> value for a two-tailed t test at a given probability error; <span class="math inline">\(Ac\)</span> is the accuracy of selection and <span class="math inline">\(\mathop \sigma \nolimits_g^2\)</span> is the genotypic variance.</p>
</div>
<div id="blup-for-genotypes-x-environment-combination" class="section level3">
<h3 class="hasAnchor">
<a href="#blup-for-genotypes-x-environment-combination" class="anchor"></a>BLUP for genotypes X environment combination</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/options">options</a></span>(<span class="dt">digits =</span> <span class="dv">4</span>)
data =<span class="st"> </span>WAASB<span class="op">$</span>GY<span class="op">$</span>BLUPgge[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,]
<span class="kw">kable</span>(data, <span class="st">"html"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="st">"striped"</span>, <span class="st">"condensed"</span>,
                <span class="dt">position =</span> <span class="st">"left"</span>, <span class="dt">full_width =</span> F, <span class="dt">font_size =</span> <span class="dv">12</span>)</code></pre></div>
<table class="table table table-striped">
<thead><tr>
<th style="text-align:left;">
ENV
</th>
<th style="text-align:left;">
GEN
</th>
<th style="text-align:right;">
BLUPge
</th>
<th style="text-align:right;">
BLUPg
</th>
<th style="text-align:right;">
BLUPg+ge
</th>
<th style="text-align:right;">
Predicted
</th>
<th style="text-align:right;">
LL
</th>
<th style="text-align:right;">
UL
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G1
</td>
<td style="text-align:right;">
-0.0621
</td>
<td style="text-align:right;">
-0.0575
</td>
<td style="text-align:right;">
-0.1196
</td>
<td style="text-align:right;">
2.401
</td>
<td style="text-align:right;">
2.298
</td>
<td style="text-align:right;">
2.505
</td>
</tr>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G10
</td>
<td style="text-align:right;">
-0.2430
</td>
<td style="text-align:right;">
-0.1655
</td>
<td style="text-align:right;">
-0.4085
</td>
<td style="text-align:right;">
2.112
</td>
<td style="text-align:right;">
2.009
</td>
<td style="text-align:right;">
2.216
</td>
</tr>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G2
</td>
<td style="text-align:right;">
0.2066
</td>
<td style="text-align:right;">
0.0570
</td>
<td style="text-align:right;">
0.2636
</td>
<td style="text-align:right;">
2.784
</td>
<td style="text-align:right;">
2.681
</td>
<td style="text-align:right;">
2.888
</td>
</tr>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G3
</td>
<td style="text-align:right;">
0.0885
</td>
<td style="text-align:right;">
0.2292
</td>
<td style="text-align:right;">
0.3176
</td>
<td style="text-align:right;">
2.838
</td>
<td style="text-align:right;">
2.735
</td>
<td style="text-align:right;">
2.942
</td>
</tr>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G4
</td>
<td style="text-align:right;">
0.0601
</td>
<td style="text-align:right;">
-0.0264
</td>
<td style="text-align:right;">
0.0337
</td>
<td style="text-align:right;">
2.554
</td>
<td style="text-align:right;">
2.451
</td>
<td style="text-align:right;">
2.658
</td>
</tr>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G5
</td>
<td style="text-align:right;">
-0.1408
</td>
<td style="text-align:right;">
-0.1116
</td>
<td style="text-align:right;">
-0.2524
</td>
<td style="text-align:right;">
2.268
</td>
<td style="text-align:right;">
2.165
</td>
<td style="text-align:right;">
2.372
</td>
</tr>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G6
</td>
<td style="text-align:right;">
-0.0673
</td>
<td style="text-align:right;">
-0.1143
</td>
<td style="text-align:right;">
-0.1816
</td>
<td style="text-align:right;">
2.339
</td>
<td style="text-align:right;">
2.236
</td>
<td style="text-align:right;">
2.443
</td>
</tr>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G7
</td>
<td style="text-align:right;">
0.1267
</td>
<td style="text-align:right;">
0.0543
</td>
<td style="text-align:right;">
0.1810
</td>
<td style="text-align:right;">
2.702
</td>
<td style="text-align:right;">
2.598
</td>
<td style="text-align:right;">
2.805
</td>
</tr>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G8
</td>
<td style="text-align:right;">
0.0702
</td>
<td style="text-align:right;">
0.2685
</td>
<td style="text-align:right;">
0.3388
</td>
<td style="text-align:right;">
2.859
</td>
<td style="text-align:right;">
2.756
</td>
<td style="text-align:right;">
2.963
</td>
</tr>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G9
</td>
<td style="text-align:right;">
-0.0389
</td>
<td style="text-align:right;">
-0.1337
</td>
<td style="text-align:right;">
-0.1726
</td>
<td style="text-align:right;">
2.348
</td>
<td style="text-align:right;">
2.244
</td>
<td style="text-align:right;">
2.451
</td>
</tr>
</tbody>
</table>
<p>This output shows the predicted means for each genotype and environment combination. <strong>BLUPg</strong> is the genotypic effect described above. <strong>BLUPge</strong> is the genotypic effect of the <em>i</em>th genotype in the <em>j</em>th environment <span class="math inline">\((\hat{g}_{ij})\)</span> estimated by <span class="math inline">\(\hat{g}_{ij} = h_g^2(\bar{y}_{i.}-\bar{y}_{..})+h_{ge}^2(y_{ij}-\bar{y}_{i.}-\bar{y}_{.j}+\bar{y}_{..})\)</span>, where <span class="math inline">\(h_{ge}^2\)</span> is the shrinkage effect for the genotype-by-environment interaction; <strong>BLUPg+ge</strong> is <span class="math inline">\(BLUP_g+BLUP_{ge}\)</span>; <strong>Predicted</strong> is the predicted mean (<span class="math inline">\(\hat{y}_{ij}\)</span>) estimated by <span class="math inline">\(\hat{y}_{ij} = \bar{y}_{.j}+BLUP_{g+ge}\)</span>.</p>
</div>
</div>
<div id="eigenvalues-from-the-svd" class="section level2">
<h2 class="hasAnchor">
<a href="#eigenvalues-from-the-svd" class="anchor"></a>Eigenvalues from the SVD</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/options">options</a></span>(<span class="dt">digits =</span> <span class="dv">4</span>)
data =<span class="st"> </span>WAASB<span class="op">$</span>GY<span class="op">$</span>PCA
<span class="kw">kable</span>(data, <span class="st">"html"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="st">"striped"</span>, <span class="st">"condensed"</span>,
                <span class="dt">position =</span> <span class="st">"left"</span>, <span class="dt">full_width =</span> F, <span class="dt">font_size =</span> <span class="dv">12</span>)</code></pre></div>
<table class="table table table-striped">
<thead><tr>
<th style="text-align:left;">
PC
</th>
<th style="text-align:right;">
Eigenvalue
</th>
<th style="text-align:right;">
Proportion
</th>
<th style="text-align:right;">
Accumulated
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
1.4722
</td>
<td style="text-align:right;">
34.3084
</td>
<td style="text-align:right;">
34.31
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
1.3467
</td>
<td style="text-align:right;">
31.3835
</td>
<td style="text-align:right;">
65.69
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
0.5479
</td>
<td style="text-align:right;">
12.7677
</td>
<td style="text-align:right;">
78.46
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
0.4167
</td>
<td style="text-align:right;">
9.7099
</td>
<td style="text-align:right;">
88.17
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
0.2126
</td>
<td style="text-align:right;">
4.9548
</td>
<td style="text-align:right;">
93.12
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:right;">
0.1397
</td>
<td style="text-align:right;">
3.2562
</td>
<td style="text-align:right;">
96.38
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:right;">
0.0791
</td>
<td style="text-align:right;">
1.8437
</td>
<td style="text-align:right;">
98.22
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:right;">
0.0567
</td>
<td style="text-align:right;">
1.3221
</td>
<td style="text-align:right;">
99.55
</td>
</tr>
<tr>
<td style="text-align:left;">
9
</td>
<td style="text-align:right;">
0.0195
</td>
<td style="text-align:right;">
0.4537
</td>
<td style="text-align:right;">
100.00
</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plot.eigen.html">plot.eigen</a></span>(WAASB<span class="op">$</span>GY, <span class="dt">size.lab =</span> <span class="dv">14</span>, <span class="dt">size.tex.lab =</span> <span class="dv">14</span>)</code></pre></div>
<p><img src="vignettes_BLUP_files/figure-html/unnamed-chunk-12-1.png" width="528" style="display: block; margin: auto;"></p>
<p>The above output shows the eigenvalues and the proportion of variance explained by each principal component axis of the BLUP interaction effects matrix.</p>
<div id="phenotypic-means" class="section level3">
<h3 class="hasAnchor">
<a href="#phenotypic-means" class="anchor"></a>Phenotypic means</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/options">options</a></span>(<span class="dt">digits =</span> <span class="dv">4</span>)
data =<span class="st"> </span>WAASB<span class="op">$</span>GY<span class="op">$</span>MeansGxE[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,]
<span class="kw">kable</span>(data, <span class="st">"html"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="st">"striped"</span>, <span class="st">"condensed"</span>,
                <span class="dt">position =</span> <span class="st">"left"</span>, <span class="dt">full_width =</span> F, <span class="dt">font_size =</span> <span class="dv">12</span>)</code></pre></div>
<table class="table table table-striped">
<thead><tr>
<th style="text-align:left;">
ENV
</th>
<th style="text-align:left;">
GEN
</th>
<th style="text-align:right;">
Y
</th>
<th style="text-align:right;">
envPC1
</th>
<th style="text-align:right;">
genPC1
</th>
<th style="text-align:right;">
nominal
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G1
</td>
<td style="text-align:right;">
2.366
</td>
<td style="text-align:right;">
0.2353
</td>
<td style="text-align:right;">
0.2459
</td>
<td style="text-align:right;">
2.662
</td>
</tr>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G10
</td>
<td style="text-align:right;">
1.974
</td>
<td style="text-align:right;">
0.2353
</td>
<td style="text-align:right;">
-0.8189
</td>
<td style="text-align:right;">
2.279
</td>
</tr>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G2
</td>
<td style="text-align:right;">
2.902
</td>
<td style="text-align:right;">
0.2353
</td>
<td style="text-align:right;">
0.1189
</td>
<td style="text-align:right;">
2.772
</td>
</tr>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G3
</td>
<td style="text-align:right;">
2.889
</td>
<td style="text-align:right;">
0.2353
</td>
<td style="text-align:right;">
0.0437
</td>
<td style="text-align:right;">
2.966
</td>
</tr>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G4
</td>
<td style="text-align:right;">
2.589
</td>
<td style="text-align:right;">
0.2353
</td>
<td style="text-align:right;">
-0.2429
</td>
<td style="text-align:right;">
2.585
</td>
</tr>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G5
</td>
<td style="text-align:right;">
2.188
</td>
<td style="text-align:right;">
0.2353
</td>
<td style="text-align:right;">
-0.2563
</td>
<td style="text-align:right;">
2.477
</td>
</tr>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G6
</td>
<td style="text-align:right;">
2.301
</td>
<td style="text-align:right;">
0.2353
</td>
<td style="text-align:right;">
-0.0753
</td>
<td style="text-align:right;">
2.516
</td>
</tr>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G7
</td>
<td style="text-align:right;">
2.774
</td>
<td style="text-align:right;">
0.2353
</td>
<td style="text-align:right;">
0.2473
</td>
<td style="text-align:right;">
2.799
</td>
</tr>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G8
</td>
<td style="text-align:right;">
2.899
</td>
<td style="text-align:right;">
0.2353
</td>
<td style="text-align:right;">
0.4042
</td>
<td style="text-align:right;">
3.099
</td>
</tr>
<tr>
<td style="text-align:left;">
E1
</td>
<td style="text-align:left;">
G9
</td>
<td style="text-align:right;">
2.326
</td>
<td style="text-align:right;">
0.2353
</td>
<td style="text-align:right;">
0.3335
</td>
<td style="text-align:right;">
2.589
</td>
</tr>
</tbody>
</table>
<p>In this output, <em>Y</em> is the phenotypic mean for each genotype and environment combination (<span class="math inline">\(y_{ij}\)</span>), estimated by <span class="math inline">\(y_{ij} = \sum_k{y_{ij}}/B\)</span> with <span class="math inline">\(k = 1,2,...B\)</span>.</p>
</div>
</div>
<div id="biplots" class="section level2">
<h2 class="hasAnchor">
<a href="#biplots" class="anchor"></a>Biplots</h2>
<p>We will show how biplots may be obtained for both traditional AMMI model, fitted by the function <code><a href="../reference/WAAS.AMMI.html">WAAS.AMMI()</a></code> and the mixed-effect model fitted by the function <code><a href="../reference/WAASB.html">WAASB()</a></code>. Provided that an object of class “WAAS.AMMI” or “WAASB” is available in the global environment, the graphics may be obtained using the function <code><a href="../reference/plot.scores.html">plot.scores()</a></code>. To do that, we will revisit the previusly fitted model <code>WAASB</code> . Please, refer to <code><a href="../reference/plot.scores.html">?plot.scores</a></code> for more details. Four types of graphics can be generated: 1 = <span class="math inline">\(PC1 \times PC2\)</span>; 2 = <span class="math inline">\(GY \times PC1\)</span>; 3 = <span class="math inline">\(GY \times WAASB\)</span>; and 4 = a graphic with nominal yield as a function of the environment PCA1 scores.</p>
<div id="biplot-type-1-pc1-x-pc2" class="section level3">
<h3 class="hasAnchor">
<a href="#biplot-type-1-pc1-x-pc2" class="anchor"></a>biplot type 1: PC1 x PC2</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(cowplot)
p1 =<span class="st"> </span><span class="kw"><a href="../reference/plot.scores.html">plot.scores</a></span>(WAASB<span class="op">$</span>GY, <span class="dt">type =</span> <span class="dv">1</span>)
p2 =<span class="st"> </span><span class="kw"><a href="../reference/plot.scores.html">plot.scores</a></span>(WAASB<span class="op">$</span>GY,
                 <span class="dt">type =</span> <span class="dv">1</span>,
                 <span class="dt">polygon =</span> <span class="ot">TRUE</span>,
                 <span class="dt">col.gen =</span> <span class="st">"black"</span>,
                 <span class="dt">col.env =</span> <span class="st">"gray70"</span>,
                 <span class="dt">col.segm.env =</span> <span class="st">"gray70"</span>,
                 <span class="dt">axis.expand =</span> <span class="fl">1.5</span>)
<span class="kw">plot_grid</span>(p1, p2, <span class="dt">labels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"p1"</span>,<span class="st">"p2"</span>))</code></pre></div>
<p><img src="vignettes_BLUP_files/figure-html/unnamed-chunk-14-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div id="biplot-type-2-gy-x-pc1" class="section level3">
<h3 class="hasAnchor">
<a href="#biplot-type-2-gy-x-pc1" class="anchor"></a>biplot type 2: GY x PC1</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p3 =<span class="st"> </span><span class="kw"><a href="../reference/plot.scores.html">plot.scores</a></span>(WAASB<span class="op">$</span>GY, <span class="dt">type =</span> <span class="dv">2</span>)
p4 =<span class="st"> </span><span class="kw"><a href="../reference/plot.scores.html">plot.scores</a></span>(WAASB<span class="op">$</span>GY, <span class="dt">type =</span> <span class="dv">2</span>,
                 <span class="dt">col.segm.env =</span> <span class="st">"transparent"</span>) <span class="op">+</span>
<span class="st">                 </span><span class="kw">theme_gray</span>() <span class="op">+</span>
<span class="st">                 </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>),
                       <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="ot">NA</span>))

<span class="kw">plot_grid</span>(p3, p4, <span class="dt">labels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"p3"</span>,<span class="st">"p4"</span>))</code></pre></div>
<p><img src="vignettes_BLUP_files/figure-html/unnamed-chunk-15-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div id="biplot-type-3-gy-x-waasb" class="section level3">
<h3 class="hasAnchor">
<a href="#biplot-type-3-gy-x-waasb" class="anchor"></a>biplot type 3: GY x WAASB</h3>
<p>The quadrants proposed in the following biplot represent the four classifications proposed here regarding the joint interpretation of productivity and stability. The genotypes or environments included in quadrant I can be considered unstable genotypes or environments with high discrimination ability, and with productivity below the grand mean. In quadrant II are included unstable genotypes, although with productivity above the grand mean. The environments included in this quadrant deserve special attention since, in addition to providing high magnitudes of the response variable, they present a good discrimination ability. Genotypes within quadrant III have low productivity, but can be considered stable due to the lower values of WAASB. The lower this value, the more stable the genotype can be considered. The environments included in this quadrant can be considered as poorly productive and with low discrimination ability. The genotypes within the quadrant IV are higly productive and broadly adapted due to the high magnitude of the response variable and high stability performance (lower values of WAASB).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p5 =<span class="st"> </span><span class="kw"><a href="../reference/plot.scores.html">plot.scores</a></span>(WAASB<span class="op">$</span>GY, <span class="dt">type =</span> <span class="dv">3</span>)
p6 =<span class="st"> </span><span class="kw"><a href="../reference/plot.scores.html">plot.scores</a></span>(WAASB<span class="op">$</span>GY, <span class="dt">type =</span> <span class="dv">3</span>,
                 <span class="dt">x.lab =</span> <span class="st">"My customized x label"</span>,
                 <span class="dt">size.shape =</span> <span class="dv">3</span>,
                 <span class="dt">size.tex.pa =</span> <span class="dv">2</span>,
                 <span class="dt">x.lim =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">1.2</span>, <span class="fl">4.7</span>),
                 <span class="dt">x.breaks =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="fl">1.5</span>, <span class="fl">4.5</span>, <span class="dt">by =</span> <span class="fl">0.5</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">                 </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>))
<span class="kw">plot_grid</span>(p5, p6, <span class="dt">labels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"p5"</span>,<span class="st">"p6"</span>))</code></pre></div>
<p><img src="vignettes_BLUP_files/figure-html/unnamed-chunk-16-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div id="biplot-type-4-nominal-yield-and-environment-ipca1" class="section level3">
<h3 class="hasAnchor">
<a href="#biplot-type-4-nominal-yield-and-environment-ipca1" class="anchor"></a>biplot type 4 : nominal yield and environment IPCA1</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plot.scores.html">plot.scores</a></span>(WAASB<span class="op">$</span>GY,
            <span class="dt">type =</span> <span class="dv">4</span>, <span class="dt">size.tex.pa =</span> <span class="fl">1.5</span>)</code></pre></div>
<p><img src="vignettes_BLUP_files/figure-html/unnamed-chunk-17-1.png" width="528" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
<div id="estimating-the-waasby-index" class="section level1">
<h1 class="hasAnchor">
<a href="#estimating-the-waasby-index" class="anchor"></a>Estimating the WAASBY index</h1>
<p>The function <code>WAASBratio</code> considers both stability (WAASB) and productivity for genotype ranking considering the following model:</p>
<p><span class="math display">\[
WAASB{Y_i} = \frac{{\left( {r{G_i} \times {\theta _Y}} \right) + \left( {r{W_i} \times {\theta _S}} \right)}}{{{\theta _Y} + {\theta _S}}}
\]</span></p>
<p>where <span class="math inline">\(WAASBY_i\)</span> is the superiority index for the <em>i</em>-th genotype that weights between performance and stability; <span class="math inline">\(rG_i\)</span> and <span class="math inline">\(rW_i\)</span> are the rescaled values (0-100) for GY and WAASB, respectively; <span class="math inline">\(\theta _Y\)</span> and <span class="math inline">\(\theta_S\)</span> are the weights for GY and WAASB, respectively.</p>
<p>This function provides the option of attributing weights for stability and productivity in genotype ranking. This is important depending on the goal of a selection strategy or cultivar reccomendation. For example, if the goal is to select a genotype with high yield (independently of the stability performance), that genotype with the first rank in a WAASB/GY = 0/100 ratio should be selected. The reciprocal is true. Aiming at selecting high-stable genotypes (independently of the productivity), that genotype with the first rank in a WAASB/GY = 100/0 ratio should be selected. By default, the increment on the WAASB/GY ratio is equal to 5 and the WAASBY values are saved when the WAASB/GY ratio is equal to 50/50. Thus, twenty one different scenarios are computed, and for each scenario, the genotypes are ranked based on the WAASBY values.</p>
<p>In the following example we will assume that we want to obtain the ranks changing the WAASB/GY ratio in 10% each scenario and to plot the WAASBY values considering a WAASB/GY ratio equal 30/70. <strong>Important! THE ARGUMENT <code>saveWAASY</code> MUST BE DIVISIBLE BY <code>increment</code>!</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">WAASBYratio =<span class="st"> </span><span class="kw"><a href="../reference/WAASBYratio.html">WAASBYratio</a></span>(dataset,
                          <span class="dt">resp =</span> GY,
                          <span class="dt">gen =</span> GEN,
                          <span class="dt">env =</span> ENV,
                          <span class="dt">rep =</span> REP,
                          <span class="dt">increment =</span> <span class="dv">50</span>,
                          <span class="dt">saveWAASY =</span> <span class="dv">50</span>)</code></pre></div>
<p>This procedure can also be used with the traditional AMMI analysis. This approach is easily implemented using the <code>WAASratio.AMMI</code> function shown in the following example.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">WAASBYratio2 =<span class="st"> </span><span class="kw"><a href="../reference/WAASratio.AMMI.html">WAASratio.AMMI</a></span>(dataset,
                              <span class="dt">resp =</span> GY,
                              <span class="dt">gen =</span> GEN,
                              <span class="dt">env =</span> ENV,
                              <span class="dt">rep =</span> REP,
                              <span class="dt">increment =</span> <span class="dv">50</span>,
                              <span class="dt">saveWAASY =</span> <span class="dv">50</span>)</code></pre></div>
<div id="printing-the-model-outputs-1" class="section level2">
<h2 class="hasAnchor">
<a href="#printing-the-model-outputs-1" class="anchor"></a>Printing the model outputs</h2>
<ul>
<li>WAASBY values</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/options">options</a></span>(<span class="dt">digits =</span> <span class="dv">4</span>)
data =<span class="st"> </span>WAASBYratio<span class="op">$</span>WAASY
<span class="kw">kable</span>(data, <span class="st">"html"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="st">"striped"</span>, <span class="st">"condensed"</span>,
                <span class="dt">position =</span> <span class="st">"left"</span>, <span class="dt">full_width =</span> F, <span class="dt">font_size =</span> <span class="dv">12</span>)</code></pre></div>
<table class="table table table-striped">
<thead><tr>
<th style="text-align:left;">
Code
</th>
<th style="text-align:right;">
PesRes
</th>
<th style="text-align:right;">
PesWAAS
</th>
<th style="text-align:right;">
WAASY
</th>
<th style="text-align:left;">
Mean
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
G10
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:left;">
below
</td>
</tr>
<tr>
<td style="text-align:left;">
G9
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
16.32
</td>
<td style="text-align:left;">
below
</td>
</tr>
<tr>
<td style="text-align:left;">
G5
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
39.95
</td>
<td style="text-align:left;">
below
</td>
</tr>
<tr>
<td style="text-align:left;">
G7
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
45.23
</td>
<td style="text-align:left;">
below
</td>
</tr>
<tr>
<td style="text-align:left;">
G4
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
45.71
</td>
<td style="text-align:left;">
below
</td>
</tr>
<tr>
<td style="text-align:left;">
G6
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
45.89
</td>
<td style="text-align:left;">
below
</td>
</tr>
<tr>
<td style="text-align:left;">
G1
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
57.62
</td>
<td style="text-align:left;">
above
</td>
</tr>
<tr>
<td style="text-align:left;">
G2
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
59.92
</td>
<td style="text-align:left;">
above
</td>
</tr>
<tr>
<td style="text-align:left;">
G8
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
77.30
</td>
<td style="text-align:left;">
above
</td>
</tr>
<tr>
<td style="text-align:left;">
G3
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
95.46
</td>
<td style="text-align:left;">
above
</td>
</tr>
</tbody>
</table>
<p>In this output, <strong>PesResp</strong> and <strong>PesWAAS</strong> are the weights attributed to response variable and stability, respecively, to compute de WAASY values.</p>
<ul>
<li>Genotype ranking for each scenario of WAASBY/GY ratio.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/options">options</a></span>(<span class="dt">digits =</span> <span class="dv">4</span>)
data =<span class="st"> </span>WAASBYratio<span class="op">$</span>hetcomb
<span class="kw">kable</span>(data, <span class="st">"html"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="st">"striped"</span>, <span class="st">"condensed"</span>,
                <span class="dt">position =</span> <span class="st">"left"</span>, <span class="dt">full_width =</span> F, <span class="dt">font_size =</span> <span class="dv">12</span>)</code></pre></div>
<table class="table table table-striped">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
100/0
</th>
<th style="text-align:right;">
50/50
</th>
<th style="text-align:right;">
0/100
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
G1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:left;">
G10
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
G2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
G3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
G4
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
G5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:left;">
G6
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:left;">
G7
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
G8
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
G9
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
9
</td>
</tr>
</tbody>
</table>
<ul>
<li>Genotype ranking depending on the number of multiplicative terms used to estimate the WAASB index.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/options">options</a></span>(<span class="dt">digits =</span> <span class="dv">4</span>)
data =<span class="st"> </span>WAASBYratio<span class="op">$</span>hetdata
<span class="kw">kable</span>(data, <span class="st">"html"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="st">"striped"</span>, <span class="st">"condensed"</span>,
                <span class="dt">position =</span> <span class="st">"left"</span>, <span class="dt">full_width =</span> F, <span class="dt">font_size =</span> <span class="dv">12</span>)</code></pre></div>
<table class="table table table-striped">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
9PCA
</th>
<th style="text-align:right;">
8PCA
</th>
<th style="text-align:right;">
7PCA
</th>
<th style="text-align:right;">
6PCA
</th>
<th style="text-align:right;">
5PCA
</th>
<th style="text-align:right;">
4PCA
</th>
<th style="text-align:right;">
3PCA
</th>
<th style="text-align:right;">
2PCA
</th>
<th style="text-align:right;">
1PCA
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
G1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
G10
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
G2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
G3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
G4
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
G5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:left;">
G6
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
G7
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:left;">
G8
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
9
</td>
</tr>
<tr>
<td style="text-align:left;">
G9
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
8
</td>
</tr>
</tbody>
</table>
</div>
<div id="plotting-the-waasby-values" class="section level2">
<h2 class="hasAnchor">
<a href="#plotting-the-waasby-values" class="anchor"></a>Plotting the WAASBY values</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)
p1 =<span class="st"> </span><span class="kw"><a href="../reference/plot.WAASBY.html">plot.WAASBY</a></span>(WAASBYratio)
p2 =<span class="st"> </span><span class="kw"><a href="../reference/plot.WAASBY.html">plot.WAASBY</a></span>(WAASBYratio, <span class="dt">col.shape =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"gray20"</span>, <span class="st">"gray80"</span>))
<span class="kw">plot_grid</span>(p1, p2, <span class="dt">labels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"p1"</span>, <span class="st">"p2"</span>))</code></pre></div>
<p><img src="vignettes_BLUP_files/figure-html/unnamed-chunk-23-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div id="plotting-the-heat-map-graphics" class="section level2">
<h2 class="hasAnchor">
<a href="#plotting-the-heat-map-graphics" class="anchor"></a>Plotting the heat map graphics</h2>
<p>The first type of heatmap shows the genotype ranking depending on the number of principal component axes used for estimating the WAASB index. An euclidean distance-based dendrogram is used for grouping the genotype ranking for both genotypes and principal component axes. The second type of heatmap shows the genotype ranking depending on the WAASB/GY ratio. The ranks obtained with a ratio of 100/0 considers exclusively the stability for genotype ranking. On the other hand, a ratio of 0/100 considers exclusively the productivity for genotype ranking. Four clusters are estimated (1) unproductive and unstable genotypes; (2) productive, but unstable genotypes; (3) stable, but unproductive genotypes; and (4), productive and stable genotypes.</p>
<div id="ranks-of-genotypes-depending-on-the-number-of-pca-used-to-estimate-the-waasb" class="section level3">
<h3 class="hasAnchor">
<a href="#ranks-of-genotypes-depending-on-the-number-of-pca-used-to-estimate-the-waasb" class="anchor"></a>Ranks of genotypes depending on the number of PCA used to estimate the WAASB</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(WAASBYratio, <span class="dt">type =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="vignettes_BLUP_files/figure-html/unnamed-chunk-24-1.png" width="528" style="display: block; margin: auto;"></p>
</div>
<div id="ranks-of-genotypes-depending-on-the-waasbgy-ratio" class="section level3">
<h3 class="hasAnchor">
<a href="#ranks-of-genotypes-depending-on-the-waasbgy-ratio" class="anchor"></a>Ranks of genotypes depending on the WAASB/GY ratio</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(WAASBYratio, <span class="dt">type =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="vignettes_BLUP_files/figure-html/unnamed-chunk-25-1.png" width="528" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
<div id="others-blup-based-stability-indexes" class="section level1">
<h1 class="hasAnchor">
<a href="#others-blup-based-stability-indexes" class="anchor"></a>Others BLUP-based stability indexes</h1>
<p><span class="citation">Colombari Filho et al. (<a href="#ref-ColombariFilho2013">2013</a>)</span> have shown the use of three BLUP-based indexes for selecting genotypes with performance and stability. The first is the harmonic mean of genotypic values -or BLUPS- (HMGV) a stability index that considers the genotype with the highest harmonic mean across environments as the most stable, as follows:</p>
<p><span class="math display">\[
HMGV_i = \frac{1}{e}\sum\limits_{j = 1}^e {\frac{1}{{BLUP_{ij}}}}
\]</span></p>
<p>The second is the relative performance of genotypic values (RPGV), an adaptability index estimated as follows:</p>
<p><span class="math display">\[
RPGV_i = \frac{1}{e}{\sum\limits_{j = 1}^e {BLUP_{ij}} /\mathop \mu \nolimits_j }
\]</span></p>
<p>The third and last is the harmonic mean of relative performance of genotypic values (HMRPGV), a simultaneous selection index for stability, adaptability and mean performance, estimated as follows:</p>
<p><span class="math display">\[
HMRPGV_i = \frac{1}{e}\sum\limits_{j = 1}^e {\frac{1}{{BLUP_{ij}/{\mu _j}}}}
\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res_inde =<span class="st"> </span><span class="kw"><a href="../reference/Resende_indexes.html">Resende_indexes</a></span>(WAASB)
<span class="kw">kable</span>(res_inde, <span class="st">"html"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="st">"striped"</span>, <span class="st">"condensed"</span>,
                <span class="dt">position =</span> <span class="st">"left"</span>, <span class="dt">full_width =</span> F, <span class="dt">font_size =</span> <span class="dv">12</span>)</code></pre></div>
<table class="table kable_wrapper table table-striped"><tbody><tr>
<td>
<table class="table">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
HMGV
</th>
<th style="text-align:right;">
HMGV_order
</th>
<th style="text-align:right;">
RPGV
</th>
<th style="text-align:right;">
GY_RPGV
</th>
<th style="text-align:right;">
RPGV_order
</th>
<th style="text-align:right;">
HMRPGV
</th>
<th style="text-align:right;">
GY_HMRPGV
</th>
<th style="text-align:right;">
HMRPGV_order
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
G1
</td>
<td style="text-align:right;">
2.316
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0.9690
</td>
<td style="text-align:right;">
2.591
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0.9667
</td>
<td style="text-align:right;">
2.585
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:left;">
G10
</td>
<td style="text-align:right;">
2.112
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0.9130
</td>
<td style="text-align:right;">
2.442
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0.8964
</td>
<td style="text-align:right;">
2.397
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
G2
</td>
<td style="text-align:right;">
2.466
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1.0253
</td>
<td style="text-align:right;">
2.742
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1.0197
</td>
<td style="text-align:right;">
2.727
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
G3
</td>
<td style="text-align:right;">
2.681
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1.1050
</td>
<td style="text-align:right;">
2.955
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1.1040
</td>
<td style="text-align:right;">
2.952
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
G4
</td>
<td style="text-align:right;">
2.388
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.9905
</td>
<td style="text-align:right;">
2.649
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.9882
</td>
<td style="text-align:right;">
2.643
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
G5
</td>
<td style="text-align:right;">
2.302
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0.9542
</td>
<td style="text-align:right;">
2.552
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0.9520
</td>
<td style="text-align:right;">
2.546
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:left;">
G6
</td>
<td style="text-align:right;">
2.304
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0.9542
</td>
<td style="text-align:right;">
2.552
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0.9521
</td>
<td style="text-align:right;">
2.546
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:left;">
G7
</td>
<td style="text-align:right;">
2.520
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1.0369
</td>
<td style="text-align:right;">
2.773
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1.0308
</td>
<td style="text-align:right;">
2.757
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
G8
</td>
<td style="text-align:right;">
2.740
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.1257
</td>
<td style="text-align:right;">
3.010
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.1222
</td>
<td style="text-align:right;">
3.001
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
G9
</td>
<td style="text-align:right;">
2.177
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
0.9262
</td>
<td style="text-align:right;">
2.477
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
0.9172
</td>
<td style="text-align:right;">
2.453
</td>
<td style="text-align:right;">
9
</td>
</tr>
</tbody>
</table>
</td>
</tr></tbody></table>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-ColombariFilho2013">
<p>Colombari Filho, J. M., M. D. V. Resende, O. P. Morais, A. P. Castro, É. P. Guimarães, J. A. Pereira, M. M. Utumi, and F. Breseghello. 2013. “Upland rice breeding in Brazil: a simultaneous genotypic evaluation of stability, adaptability and grain yield.” <em>Euphytica</em> 192 (1): 117–29. doi:<a href="https://doi.org/10.1007/s10681-013-0922-2">10.1007/s10681-013-0922-2</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#getting-started">Getting started</a></li>
      <li>
<a href="#estimating-the-waasb-based-on-svd-of-blup-interaction-effects">Estimating the WAASB (based on SVD of BLUP-interaction effects)</a><ul class="nav nav-pills nav-stacked">
<li><a href="#diagnostic-plot-for-residuals">Diagnostic plot for residuals</a></li>
      <li><a href="#printing-the-model-outputs">Printing the model outputs</a></li>
      <li><a href="#eigenvalues-from-the-svd">Eigenvalues from the SVD</a></li>
      <li><a href="#biplots">Biplots</a></li>
      </ul>
</li>
      <li>
<a href="#estimating-the-waasby-index">Estimating the WAASBY index</a><ul class="nav nav-pills nav-stacked">
<li><a href="#printing-the-model-outputs-1">Printing the model outputs</a></li>
      <li><a href="#plotting-the-waasby-values">Plotting the WAASBY values</a></li>
      <li><a href="#plotting-the-heat-map-graphics">Plotting the heat map graphics</a></li>
      </ul>
</li>
      <li><a href="#others-blup-based-stability-indexes">Others BLUP-based stability indexes</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://www.mendeley.com/profiles/tiago-olivoto/">Tiago Olivoto</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
